<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AscEmu: AscEmu/dep/StormLib/src/SFileFindFile.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="AscEmu.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AscEmu
   </div>
   <div id="projectbrief">OpenSource WoW Emulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SFileFindFile_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">SFileFindFile.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="StormLib_8h_source.html">StormLib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="StormCommon_8h_source.html">StormCommon.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SFileFindFile.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp__incl.svg" width="100%" height="569"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp__dep__incl.svg" width="196" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="SFileFindFile_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTMPQSearch.html">TMPQSearch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6c6f05f604e9e3c9c3536365c5f81665" id="r_a6c6f05f604e9e3c9c3536365c5f81665"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a6c6f05f604e9e3c9c3536365c5f81665">__STORMLIB_SELF__</a></td></tr>
<tr class="separator:a6c6f05f604e9e3c9c3536365c5f81665"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae86cfd67ac2d45b236721b35e2ca1313" id="r_ae86cfd67ac2d45b236721b35e2ca1313"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#ae86cfd67ac2d45b236721b35e2ca1313">IsValidSearchHandle</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFind)</td></tr>
<tr class="separator:ae86cfd67ac2d45b236721b35e2ca1313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a025a0f97982f04996b923c97ff795" id="r_a73a025a0f97982f04996b923c97ff795"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a> (<a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szString, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szWildCard)</td></tr>
<tr class="separator:a73a025a0f97982f04996b923c97ff795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20237f9fdc0cdd196e238b09c00e07e" id="r_ad20237f9fdc0cdd196e238b09c00e07e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#ad20237f9fdc0cdd196e238b09c00e07e">GetSearchTableItems</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha)</td></tr>
<tr class="separator:ad20237f9fdc0cdd196e238b09c00e07e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df1af7993593c3d91a62befb3c760ca" id="r_a6df1af7993593c3d91a62befb3c760ca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a6df1af7993593c3d91a62befb3c760ca">FileWasFoundBefore</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="structTMPQSearch.html">TMPQSearch</a> *hs, <a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *pFileEntry)</td></tr>
<tr class="separator:a6df1af7993593c3d91a62befb3c760ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe2bb0b5130da0c25ecbcc8417fe1aae" id="r_abe2bb0b5130da0c25ecbcc8417fe1aae"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#abe2bb0b5130da0c25ecbcc8417fe1aae">FindPatchEntry</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *pFileEntry)</td></tr>
<tr class="separator:abe2bb0b5130da0c25ecbcc8417fe1aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e659a791f58689aa8aba2d48e5742f" id="r_aa5e659a791f58689aa8aba2d48e5742f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#aa5e659a791f58689aa8aba2d48e5742f">DoMPQSearch_FileEntry</a> (<a class="el" href="structTMPQSearch.html">TMPQSearch</a> *hs, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData, <a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormLib_8h.html#a3931032d33f7a8276dd15d842b04ce0c">TMPQHash</a> *pHashEntry, <a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *pFileEntry)</td></tr>
<tr class="separator:aa5e659a791f58689aa8aba2d48e5742f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f8227ca1a03c0d33807ca279f1ba26" id="r_ac6f8227ca1a03c0d33807ca279f1ba26"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#ac6f8227ca1a03c0d33807ca279f1ba26">DoMPQSearch_HashTable</a> (<a class="el" href="structTMPQSearch.html">TMPQSearch</a> *hs, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData, <a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha)</td></tr>
<tr class="separator:ac6f8227ca1a03c0d33807ca279f1ba26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a5849b5643afbf764895b09b9282c65" id="r_a4a5849b5643afbf764895b09b9282c65"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a4a5849b5643afbf764895b09b9282c65">DoMPQSearch_FileTable</a> (<a class="el" href="structTMPQSearch.html">TMPQSearch</a> *hs, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData, <a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha)</td></tr>
<tr class="separator:a4a5849b5643afbf764895b09b9282c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4812686674104aa8e2938531cf2111" id="r_acc4812686674104aa8e2938531cf2111"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#acc4812686674104aa8e2938531cf2111">DoMPQSearch</a> (<a class="el" href="structTMPQSearch.html">TMPQSearch</a> *hs, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData)</td></tr>
<tr class="separator:acc4812686674104aa8e2938531cf2111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b7f1280ba34ac20d05c9bd02d59c22" id="r_ac5b7f1280ba34ac20d05c9bd02d59c22"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#ac5b7f1280ba34ac20d05c9bd02d59c22">FreeMPQSearch</a> (<a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&amp;hs)</td></tr>
<tr class="separator:ac5b7f1280ba34ac20d05c9bd02d59c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d4954b949694dc170b05364c2add5cd" id="r_a0d4954b949694dc170b05364c2add5cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a0d4954b949694dc170b05364c2add5cd">SFileFindFirstFile</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szMask, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *szListFile)</td></tr>
<tr class="separator:a0d4954b949694dc170b05364c2add5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a04c684ebc812ab085d9615d1bce183" id="r_a9a04c684ebc812ab085d9615d1bce183"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a9a04c684ebc812ab085d9615d1bce183">SFileFindNextFile</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFind, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData)</td></tr>
<tr class="separator:a9a04c684ebc812ab085d9615d1bce183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ff6856104b147ef82a90e86699ca15" id="r_a33ff6856104b147ef82a90e86699ca15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileFindFile_8cpp.html#a33ff6856104b147ef82a90e86699ca15">SFileFindClose</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFind)</td></tr>
<tr class="separator:a33ff6856104b147ef82a90e86699ca15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6c6f05f604e9e3c9c3536365c5f81665" name="a6c6f05f604e9e3c9c3536365c5f81665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6f05f604e9e3c9c3536365c5f81665">&#9670;&#160;</a></span>__STORMLIB_SELF__</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __STORMLIB_SELF__</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00011">11</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acc4812686674104aa8e2938531cf2111" name="acc4812686674104aa8e2938531cf2111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4812686674104aa8e2938531cf2111">&#9670;&#160;</a></span>DoMPQSearch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> DoMPQSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00337">337</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  338</span>{</div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_struct" href="struct__TMPQArchive.html">TMPQArchive</a> * ha = hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">ha</a>;</div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">// Start searching with base MPQ</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">while</span>(ha != NULL)</div>
<div class="line"><span class="lineno">  344</span>    {</div>
<div class="line"><span class="lineno">  345</span>        <span class="comment">// If the archive has hash table, we need to use hash table</span></div>
<div class="line"><span class="lineno">  346</span>        <span class="comment">// in order to catch hash table index and file locale.</span></div>
<div class="line"><span class="lineno">  347</span>        <span class="comment">// Note: If multiple hash table entries, point to the same block entry,</span></div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">// we need, to report them all</span></div>
<div class="line"><span class="lineno">  349</span>        dwErrCode = (ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> != NULL) ? <a class="code hl_function" href="SFileFindFile_8cpp.html#ac6f8227ca1a03c0d33807ca279f1ba26">DoMPQSearch_HashTable</a>(hs, lpFindFileData, ha)</div>
<div class="line"><span class="lineno">  350</span>                                             : <a class="code hl_function" href="SFileFindFile_8cpp.html#a4a5849b5643afbf764895b09b9282c65">DoMPQSearch_FileTable</a>(hs, lpFindFileData, ha);</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  352</span>            <span class="keywordflow">return</span> dwErrCode;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>        <span class="comment">// If there is no more patches in the chain, stop it.</span></div>
<div class="line"><span class="lineno">  355</span>        <span class="comment">// This also keeps hs-&gt;ha non-NULL, which is required</span></div>
<div class="line"><span class="lineno">  356</span>        <span class="comment">// for freeing the handle later</span></div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a> == NULL)</div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        <span class="comment">// Move to the next patch in the patch chain</span></div>
<div class="line"><span class="lineno">  361</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">ha</a> = ha = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a>;</div>
<div class="line"><span class="lineno">  362</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">dwNextIndex</a> = 0;</div>
<div class="line"><span class="lineno">  363</span>    }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="comment">// No more files found, return error</span></div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a>;</div>
<div class="line"><span class="lineno">  367</span>}</div>
<div class="ttc" id="aSFileFindFile_8cpp_html_a4a5849b5643afbf764895b09b9282c65"><div class="ttname"><a href="SFileFindFile_8cpp.html#a4a5849b5643afbf764895b09b9282c65">DoMPQSearch_FileTable</a></div><div class="ttdeci">static DWORD DoMPQSearch_FileTable(TMPQSearch *hs, SFILE_FIND_DATA *lpFindFileData, TMPQArchive *ha)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00316">SFileFindFile.cpp:316</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_ac6f8227ca1a03c0d33807ca279f1ba26"><div class="ttname"><a href="SFileFindFile_8cpp.html#ac6f8227ca1a03c0d33807ca279f1ba26">DoMPQSearch_HashTable</a></div><div class="ttdeci">static DWORD DoMPQSearch_HashTable(TMPQSearch *hs, SFILE_FIND_DATA *lpFindFileData, TMPQArchive *ha)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00292">SFileFindFile.cpp:292</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a798af1e30bc65f319c1a246cecf59e39"><div class="ttname"><a href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a></div><div class="ttdeci">unsigned int DWORD</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00336">StormPort.h:336</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a9f424565beb1161bf33b31748c6c16ba"><div class="ttname"><a href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a></div><div class="ttdeci">#define ERROR_NO_MORE_FILES</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00413">StormPort.h:413</a></div></div>
<div class="ttc" id="aStormPort_8h_html_aea0ae801b7d25c979655a7eb20d034af"><div class="ttname"><a href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a></div><div class="ttdeci">#define ERROR_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00401">StormPort.h:401</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_ab780ac9f795773523f227d9e7209fa2e"><div class="ttname"><a href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">TMPQSearch::ha</a></div><div class="ttdeci">TMPQArchive * ha</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00021">SFileFindFile.cpp:21</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_af7e073e7adf1be6bcc9caa622b96a136"><div class="ttname"><a href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">TMPQSearch::dwNextIndex</a></div><div class="ttdeci">DWORD dwNextIndex</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00024">SFileFindFile.cpp:24</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html"><div class="ttname"><a href="struct__TMPQArchive.html">_TMPQArchive</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00816">StormLib.h:817</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_aa2646402b5718a74c1908745ea6a46cd"><div class="ttname"><a href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">_TMPQArchive::haPatch</a></div><div class="ttdeci">struct _TMPQArchive * haPatch</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00824">StormLib.h:824</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_ad3ec9127fcae2cd440073adbc3f21fba"><div class="ttname"><a href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">_TMPQArchive::pHashTable</a></div><div class="ttdeci">TMPQHash * pHashTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00830">StormLib.h:830</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_acc4812686674104aa8e2938531cf2111_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_acc4812686674104aa8e2938531cf2111_icgraph.svg" width="586" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa5e659a791f58689aa8aba2d48e5742f" name="aa5e659a791f58689aa8aba2d48e5742f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e659a791f58689aa8aba2d48e5742f">&#9670;&#160;</a></span>DoMPQSearch_FileEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> DoMPQSearch_FileEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a3931032d33f7a8276dd15d842b04ce0c">TMPQHash</a> *&#160;</td>
          <td class="paramname"><em>pHashEntry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *&#160;</td>
          <td class="paramname"><em>pFileEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00206">206</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>{</div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pPatchEntry;</div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_typedef" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFile = NULL;</div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFileName;</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordtype">size_t</span> nPrefixLength = (ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a> != NULL) ? ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#a9b9249401510b3bf766f8d20e716fd67">nLength</a> : 0;</div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwBlockIndex;</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordtype">char</span> szNameBuff[<a class="code hl_define" href="StormPort_8h.html#ab99ded389af74001a6298fc9e44e74e5">MAX_PATH</a>];</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="comment">// Is it a file but not a patch file?</span></div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">if</span>((pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">dwFlags</a> &amp; hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ad79b7c9e8e617622f2c3fc8c9f9220f9">dwFlagMask</a>) == <a class="code hl_define" href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a>)</div>
<div class="line"><span class="lineno">  222</span>    {</div>
<div class="line"><span class="lineno">  223</span>        <span class="comment">// Ignore fake files which are not compressed but have size higher than the archive</span></div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">if</span>((pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">dwFlags</a> &amp; <a class="code hl_define" href="StormLib_8h.html#a16951666146d61c988c6d7155493be82">MPQ_FILE_COMPRESS_MASK</a>) == 0 &amp;&amp; (pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#ac1d03293cafba09c581d1ce3b20cce11">dwFileSize</a> &gt; ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a98a7c7bef18769c1ff4a9ea917a4e4a4">FileSize</a>))</div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>        <span class="comment">// Now we have to check if this file was not enumerated before</span></div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">if</span>(!<a class="code hl_function" href="SFileFindFile_8cpp.html#a6df1af7993593c3d91a62befb3c760ca">FileWasFoundBefore</a>(ha, hs, pFileEntry))</div>
<div class="line"><span class="lineno">  229</span>        {</div>
<div class="line"><span class="lineno">  230</span><span class="comment">//          if(pFileEntry != NULL &amp;&amp; !_stricmp(pFileEntry-&gt;szFileName, &quot;TriggerLibs\\NativeLib.galaxy&quot;))</span></div>
<div class="line"><span class="lineno">  231</span><span class="comment">//              DebugBreak();</span></div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>            <span class="comment">// Find a patch to this file</span></div>
<div class="line"><span class="lineno">  234</span>            <span class="comment">// Note: This either succeeds or returns pFileEntry</span></div>
<div class="line"><span class="lineno">  235</span>            pPatchEntry = <a class="code hl_function" href="SFileFindFile_8cpp.html#abe2bb0b5130da0c25ecbcc8417fe1aae">FindPatchEntry</a>(ha, pFileEntry);</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">// Prepare the block index</span></div>
<div class="line"><span class="lineno">  238</span>            dwBlockIndex = (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)(pFileEntry - ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a>);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>            <span class="comment">// Get the file name. If it&#39;s not known, we will create pseudo-name</span></div>
<div class="line"><span class="lineno">  241</span>            szFileName = pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>;</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">if</span>(szFileName == NULL)</div>
<div class="line"><span class="lineno">  243</span>            {</div>
<div class="line"><span class="lineno">  244</span>                <span class="comment">// Open the file by its pseudo-name.</span></div>
<div class="line"><span class="lineno">  245</span>                <a class="code hl_function" href="SBaseCommon_8cpp.html#ab90aae0fd7008a7d97350dde92a21f77">StringCreatePseudoFileName</a>(szNameBuff, <a class="code hl_define" href="StormPort_8h.html#a4987dd6844197a1b6267f4261ae70cf3">_countof</a>(szNameBuff), dwBlockIndex, <span class="stringliteral">&quot;xxx&quot;</span>);</div>
<div class="line"><span class="lineno">  246</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileOpenFileEx_8cpp.html#a0049c66b1dbb981f5b69afe6bbe60313">SFileOpenFileEx</a>((<a class="code hl_typedef" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>)hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">ha</a>, szNameBuff, <a class="code hl_define" href="StormLib_8h.html#a1624257a38d19c0d19bb4af7edbec9c7">SFILE_OPEN_BASE_FILE</a>, &amp;hFile))</div>
<div class="line"><span class="lineno">  247</span>                {</div>
<div class="line"><span class="lineno">  248</span>                    <a class="code hl_function" href="SFileGetFileInfo_8cpp.html#a3909beee4f92f439ad52faef54a6a296">SFileGetFileName</a>(hFile, szNameBuff);</div>
<div class="line"><span class="lineno">  249</span>                    szFileName = szNameBuff;</div>
<div class="line"><span class="lineno">  250</span>                    <a class="code hl_function" href="SFileOpenFileEx_8cpp.html#a49a09a38e6dc3b1afd95163a1c9052c6">SFileCloseFile</a>(hFile);</div>
<div class="line"><span class="lineno">  251</span>                }</div>
<div class="line"><span class="lineno">  252</span>            }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>            <span class="comment">// If the file name is still NULL, we cannot include the file to search results</span></div>
<div class="line"><span class="lineno">  255</span>            <span class="keywordflow">if</span>(szFileName != NULL)</div>
<div class="line"><span class="lineno">  256</span>            {</div>
<div class="line"><span class="lineno">  257</span>                <span class="comment">// Check the file name against the wildcard</span></div>
<div class="line"><span class="lineno">  258</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a>(szFileName + nPrefixLength, hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab9584a44e0ce7f6bdc530909ed2b8349">szSearchMask</a>))</div>
<div class="line"><span class="lineno">  259</span>                {</div>
<div class="line"><span class="lineno">  260</span>                    <span class="comment">// Fill the found entry. hash entry and block index are taken from the base MPQ</span></div>
<div class="line"><span class="lineno">  261</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a49c3c9ed799f0d23ea79af3970f80d09">dwHashIndex</a>  = <a class="code hl_define" href="StormLib_8h.html#add57a74c393d7762e00da5327cff55b5">HASH_ENTRY_FREE</a>;</div>
<div class="line"><span class="lineno">  262</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#aceb44de563a1ba438b152c907f221e7e">dwBlockIndex</a> = dwBlockIndex;</div>
<div class="line"><span class="lineno">  263</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a29ea5967ac3e3ea1b26bf1d096a47bd8">dwFileSize</a>   = pPatchEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#ac1d03293cafba09c581d1ce3b20cce11">dwFileSize</a>;</div>
<div class="line"><span class="lineno">  264</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a55ae9a234febc8889922d7f5c249fc45">dwFileFlags</a>  = pPatchEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">dwFlags</a>;</div>
<div class="line"><span class="lineno">  265</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a13db68938ced83dd70531c784efc52e6">dwCompSize</a>   = pPatchEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#af0800e75c1cfe47b9fdab963b33c003d">dwCmpSize</a>;</div>
<div class="line"><span class="lineno">  266</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a0a74d2a35cd9465d77bc04b1f14e4f08">lcLocale</a>     = 0;   <span class="comment">// pPatchEntry-&gt;lcFileLocale;</span></div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>                    <span class="comment">// Fill the filetime</span></div>
<div class="line"><span class="lineno">  269</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#ab1c026d07534f257c1e2534f535aea61">dwFileTimeHi</a> = (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)(pPatchEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#a642c4c57f60732e0daef2343acd443f5">FileTime</a> &gt;&gt; 32);</div>
<div class="line"><span class="lineno">  270</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a4d88c2f67b387c39d908da51baf70314">dwFileTimeLo</a> = (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)(pPatchEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#a642c4c57f60732e0daef2343acd443f5">FileTime</a>);</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>                    <span class="comment">// Fill-in the entries from hash table entry, if given</span></div>
<div class="line"><span class="lineno">  273</span>                    <span class="keywordflow">if</span>(pHashEntry != NULL)</div>
<div class="line"><span class="lineno">  274</span>                    {</div>
<div class="line"><span class="lineno">  275</span>                        lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a49c3c9ed799f0d23ea79af3970f80d09">dwHashIndex</a> = (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)(pHashEntry - ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a>);</div>
<div class="line"><span class="lineno">  276</span>                        lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a0a74d2a35cd9465d77bc04b1f14e4f08">lcLocale</a> = <a class="code hl_define" href="StormLib_8h.html#aac5d37546e56cecc39acc9223a466f74">SFILE_MAKE_LCID</a>(pHashEntry-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#a739c78235438c89d2cd6e6c0d44402ce">Locale</a>, pHashEntry-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#a8712ff7211834dfc7314c5d682866d88">Platform</a>);</div>
<div class="line"><span class="lineno">  277</span>                    }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>                    <span class="comment">// Fill the file name and plain file name</span></div>
<div class="line"><span class="lineno">  280</span>                    <a class="code hl_function" href="SBaseCommon_8cpp.html#ac1750bd8c861039e8dc624fd3e45ebe0">StringCopy</a>(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>, <a class="code hl_define" href="StormPort_8h.html#a4987dd6844197a1b6267f4261ae70cf3">_countof</a>(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>), szFileName + nPrefixLength);</div>
<div class="line"><span class="lineno">  281</span>                    lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#acad9ea60b6c9fd4f11b2d61a7c0f6c44">szPlainName</a> = (<span class="keywordtype">char</span> *)<a class="code hl_function" href="StormCommon_8h.html#a8fc990bc1501f75eaf124cb4d37f8ad0">GetPlainFileName</a>(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>);</div>
<div class="line"><span class="lineno">  282</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  283</span>                }</div>
<div class="line"><span class="lineno">  284</span>            }</div>
<div class="line"><span class="lineno">  285</span>        }</div>
<div class="line"><span class="lineno">  286</span>    }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// Either not a valid item or was found before</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  290</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_ab90aae0fd7008a7d97350dde92a21f77"><div class="ttname"><a href="SBaseCommon_8cpp.html#ab90aae0fd7008a7d97350dde92a21f77">StringCreatePseudoFileName</a></div><div class="ttdeci">void StringCreatePseudoFileName(char *szBuffer, size_t cchMaxChars, unsigned int nIndex, const char *szExtension)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00130">SBaseCommon.cpp:130</a></div></div>
<div class="ttc" id="aSBaseCommon_8cpp_html_ac1750bd8c861039e8dc624fd3e45ebe0"><div class="ttname"><a href="SBaseCommon_8cpp.html#ac1750bd8c861039e8dc624fd3e45ebe0">StringCopy</a></div><div class="ttdeci">char * StringCopy(char *szTarget, size_t cchTarget, const char *szSource)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00100">SBaseCommon.cpp:100</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_a6df1af7993593c3d91a62befb3c760ca"><div class="ttname"><a href="SFileFindFile_8cpp.html#a6df1af7993593c3d91a62befb3c760ca">FileWasFoundBefore</a></div><div class="ttdeci">static bool FileWasFoundBefore(TMPQArchive *ha, TMPQSearch *hs, TFileEntry *pFileEntry)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00113">SFileFindFile.cpp:113</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_a73a025a0f97982f04996b923c97ff795"><div class="ttname"><a href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a></div><div class="ttdeci">bool SFileCheckWildCard(const char *szString, const char *szWildCard)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00042">SFileFindFile.cpp:42</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_abe2bb0b5130da0c25ecbcc8417fe1aae"><div class="ttname"><a href="SFileFindFile_8cpp.html#abe2bb0b5130da0c25ecbcc8417fe1aae">FindPatchEntry</a></div><div class="ttdeci">static TFileEntry * FindPatchEntry(TMPQArchive *ha, TFileEntry *pFileEntry)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00174">SFileFindFile.cpp:174</a></div></div>
<div class="ttc" id="aSFileGetFileInfo_8cpp_html_a3909beee4f92f439ad52faef54a6a296"><div class="ttname"><a href="SFileGetFileInfo_8cpp.html#a3909beee4f92f439ad52faef54a6a296">SFileGetFileName</a></div><div class="ttdeci">bool WINAPI SFileGetFileName(HANDLE hFile, char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SFileGetFileInfo_8cpp_source.html#l00565">SFileGetFileInfo.cpp:565</a></div></div>
<div class="ttc" id="aSFileOpenFileEx_8cpp_html_a0049c66b1dbb981f5b69afe6bbe60313"><div class="ttname"><a href="SFileOpenFileEx_8cpp.html#a0049c66b1dbb981f5b69afe6bbe60313">SFileOpenFileEx</a></div><div class="ttdeci">bool WINAPI SFileOpenFileEx(HANDLE hMpq, const char *szFileName, DWORD dwSearchScope, HANDLE *PtrFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileOpenFileEx_8cpp_source.html#l00232">SFileOpenFileEx.cpp:232</a></div></div>
<div class="ttc" id="aSFileOpenFileEx_8cpp_html_a49a09a38e6dc3b1afd95163a1c9052c6"><div class="ttname"><a href="SFileOpenFileEx_8cpp.html#a49a09a38e6dc3b1afd95163a1c9052c6">SFileCloseFile</a></div><div class="ttdeci">bool WINAPI SFileCloseFile(HANDLE hFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileOpenFileEx_8cpp_source.html#l00405">SFileOpenFileEx.cpp:405</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a8fc990bc1501f75eaf124cb4d37f8ad0"><div class="ttname"><a href="StormCommon_8h.html#a8fc990bc1501f75eaf124cb4d37f8ad0">GetPlainFileName</a></div><div class="ttdeci">const XCHAR * GetPlainFileName(const XCHAR *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00359">StormCommon.h:359</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a1624257a38d19c0d19bb4af7edbec9c7"><div class="ttname"><a href="StormLib_8h.html#a1624257a38d19c0d19bb4af7edbec9c7">SFILE_OPEN_BASE_FILE</a></div><div class="ttdeci">#define SFILE_OPEN_BASE_FILE</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00182">StormLib.h:182</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a16951666146d61c988c6d7155493be82"><div class="ttname"><a href="StormLib_8h.html#a16951666146d61c988c6d7155493be82">MPQ_FILE_COMPRESS_MASK</a></div><div class="ttdeci">#define MPQ_FILE_COMPRESS_MASK</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00229">StormLib.h:229</a></div></div>
<div class="ttc" id="aStormLib_8h_html_aac5d37546e56cecc39acc9223a466f74"><div class="ttname"><a href="StormLib_8h.html#aac5d37546e56cecc39acc9223a466f74">SFILE_MAKE_LCID</a></div><div class="ttdeci">#define SFILE_MAKE_LCID(locale, platform)</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00999">StormLib.h:999</a></div></div>
<div class="ttc" id="aStormLib_8h_html_add57a74c393d7762e00da5327cff55b5"><div class="ttname"><a href="StormLib_8h.html#add57a74c393d7762e00da5327cff55b5">HASH_ENTRY_FREE</a></div><div class="ttdeci">#define HASH_ENTRY_FREE</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00170">StormLib.h:170</a></div></div>
<div class="ttc" id="aStormLib_8h_html_af6f21d7e58bf7855583c8f9667467432"><div class="ttname"><a href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a></div><div class="ttdeci">#define MPQ_FILE_EXISTS</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00226">StormLib.h:226</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a4987dd6844197a1b6267f4261ae70cf3"><div class="ttname"><a href="StormPort_8h.html#a4987dd6844197a1b6267f4261ae70cf3">_countof</a></div><div class="ttdeci">#define _countof(x)</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00421">StormPort.h:421</a></div></div>
<div class="ttc" id="aStormPort_8h_html_aa8c0374618b33785ccb02f74bcfebc46"><div class="ttname"><a href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a></div><div class="ttdeci">void * HANDLE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00342">StormPort.h:342</a></div></div>
<div class="ttc" id="aStormPort_8h_html_ab99ded389af74001a6298fc9e44e74e5"><div class="ttname"><a href="StormPort_8h.html#ab99ded389af74001a6298fc9e44e74e5">MAX_PATH</a></div><div class="ttdeci">#define MAX_PATH</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00360">StormPort.h:360</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_ab9584a44e0ce7f6bdc530909ed2b8349"><div class="ttname"><a href="structTMPQSearch.html#ab9584a44e0ce7f6bdc530909ed2b8349">TMPQSearch::szSearchMask</a></div><div class="ttdeci">char szSearchMask[1]</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00026">SFileFindFile.cpp:26</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_ad79b7c9e8e617622f2c3fc8c9f9220f9"><div class="ttname"><a href="structTMPQSearch.html#ad79b7c9e8e617622f2c3fc8c9f9220f9">TMPQSearch::dwFlagMask</a></div><div class="ttdeci">DWORD dwFlagMask</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00025">SFileFindFile.cpp:25</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a0a74d2a35cd9465d77bc04b1f14e4f08"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a0a74d2a35cd9465d77bc04b1f14e4f08">_SFILE_FIND_DATA::lcLocale</a></div><div class="ttdeci">LCID lcLocale</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00914">StormLib.h:914</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a13db68938ced83dd70531c784efc52e6"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a13db68938ced83dd70531c784efc52e6">_SFILE_FIND_DATA::dwCompSize</a></div><div class="ttdeci">DWORD dwCompSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00911">StormLib.h:911</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a29ea5967ac3e3ea1b26bf1d096a47bd8"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a29ea5967ac3e3ea1b26bf1d096a47bd8">_SFILE_FIND_DATA::dwFileSize</a></div><div class="ttdeci">DWORD dwFileSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00909">StormLib.h:909</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a49c3c9ed799f0d23ea79af3970f80d09"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a49c3c9ed799f0d23ea79af3970f80d09">_SFILE_FIND_DATA::dwHashIndex</a></div><div class="ttdeci">DWORD dwHashIndex</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00907">StormLib.h:907</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a4d88c2f67b387c39d908da51baf70314"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a4d88c2f67b387c39d908da51baf70314">_SFILE_FIND_DATA::dwFileTimeLo</a></div><div class="ttdeci">DWORD dwFileTimeLo</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00912">StormLib.h:912</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a55ae9a234febc8889922d7f5c249fc45"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a55ae9a234febc8889922d7f5c249fc45">_SFILE_FIND_DATA::dwFileFlags</a></div><div class="ttdeci">DWORD dwFileFlags</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00910">StormLib.h:910</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a9ae6998520897bcbbb9fd9971bce2d1e"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">_SFILE_FIND_DATA::cFileName</a></div><div class="ttdeci">char cFileName[MAX_PATH]</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00905">StormLib.h:905</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_ab1c026d07534f257c1e2534f535aea61"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#ab1c026d07534f257c1e2534f535aea61">_SFILE_FIND_DATA::dwFileTimeHi</a></div><div class="ttdeci">DWORD dwFileTimeHi</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00913">StormLib.h:913</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_acad9ea60b6c9fd4f11b2d61a7c0f6c44"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#acad9ea60b6c9fd4f11b2d61a7c0f6c44">_SFILE_FIND_DATA::szPlainName</a></div><div class="ttdeci">char * szPlainName</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00906">StormLib.h:906</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_aceb44de563a1ba438b152c907f221e7e"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#aceb44de563a1ba438b152c907f221e7e">_SFILE_FIND_DATA::dwBlockIndex</a></div><div class="ttdeci">DWORD dwBlockIndex</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00908">StormLib.h:908</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html"><div class="ttname"><a href="struct__TFileEntry.html">_TFileEntry</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00686">StormLib.h:687</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_a642c4c57f60732e0daef2343acd443f5"><div class="ttname"><a href="struct__TFileEntry.html#a642c4c57f60732e0daef2343acd443f5">_TFileEntry::FileTime</a></div><div class="ttdeci">ULONGLONG FileTime</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00690">StormLib.h:690</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_aa00a675cf553d128b1e3b5fdd9cdca0e"><div class="ttname"><a href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">_TFileEntry::szFileName</a></div><div class="ttdeci">char * szFileName</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00696">StormLib.h:696</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_aac45e6e4f80c412a0204abd334bc7f9b"><div class="ttname"><a href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">_TFileEntry::dwFlags</a></div><div class="ttdeci">DWORD dwFlags</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00693">StormLib.h:693</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_ac1d03293cafba09c581d1ce3b20cce11"><div class="ttname"><a href="struct__TFileEntry.html#ac1d03293cafba09c581d1ce3b20cce11">_TFileEntry::dwFileSize</a></div><div class="ttdeci">DWORD dwFileSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00691">StormLib.h:691</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_af0800e75c1cfe47b9fdab963b33c003d"><div class="ttname"><a href="struct__TFileEntry.html#af0800e75c1cfe47b9fdab963b33c003d">_TFileEntry::dwCmpSize</a></div><div class="ttdeci">DWORD dwCmpSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00692">StormLib.h:692</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a751b7e69dec82e5c9657080c8148e5e3"><div class="ttname"><a href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">_TMPQArchive::pPatchPrefix</a></div><div class="ttdeci">TMPQNamePrefix * pPatchPrefix</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00826">StormLib.h:826</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a82a7283606d9775df50cb1c683280db1"><div class="ttname"><a href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">_TMPQArchive::pFileTable</a></div><div class="ttdeci">TFileEntry * pFileTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00832">StormLib.h:832</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a98a7c7bef18769c1ff4a9ea917a4e4a4"><div class="ttname"><a href="struct__TMPQArchive.html#a98a7c7bef18769c1ff4a9ea917a4e4a4">_TMPQArchive::FileSize</a></div><div class="ttdeci">ULONGLONG FileSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00822">StormLib.h:822</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_a739c78235438c89d2cd6e6c0d44402ce"><div class="ttname"><a href="struct__TMPQHash.html#a739c78235438c89d2cd6e6c0d44402ce">_TMPQHash::Locale</a></div><div class="ttdeci">USHORT Locale</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00631">StormLib.h:631</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_a8712ff7211834dfc7314c5d682866d88"><div class="ttname"><a href="struct__TMPQHash.html#a8712ff7211834dfc7314c5d682866d88">_TMPQHash::Platform</a></div><div class="ttdeci">BYTE Platform</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00635">StormLib.h:635</a></div></div>
<div class="ttc" id="astruct__TMPQNamePrefix_html_a9b9249401510b3bf766f8d20e716fd67"><div class="ttname"><a href="struct__TMPQNamePrefix.html#a9b9249401510b3bf766f8d20e716fd67">_TMPQNamePrefix::nLength</a></div><div class="ttdeci">size_t nLength</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00798">StormLib.h:798</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_aa5e659a791f58689aa8aba2d48e5742f_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_aa5e659a791f58689aa8aba2d48e5742f_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a4a5849b5643afbf764895b09b9282c65" name="a4a5849b5643afbf764895b09b9282c65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a5849b5643afbf764895b09b9282c65">&#9670;&#160;</a></span>DoMPQSearch_FileTable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> DoMPQSearch_FileTable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00316">316</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  317</span>{</div>
<div class="line"><span class="lineno">  318</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pFileTableEnd = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a> + ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">dwFileTableSize</a>;</div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pFileEntry;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <span class="comment">// Parse the file table</span></div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">for</span>(pFileEntry = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a> + hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">dwNextIndex</a>; pFileEntry &lt; pFileTableEnd; pFileEntry++)</div>
<div class="line"><span class="lineno">  323</span>    {</div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">// Increment the next index for subsequent search</span></div>
<div class="line"><span class="lineno">  325</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">dwNextIndex</a>++;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>        <span class="comment">// Check if this file entry should be included in the search result</span></div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileFindFile_8cpp.html#aa5e659a791f58689aa8aba2d48e5742f">DoMPQSearch_FileEntry</a>(hs, lpFindFileData, ha, NULL, pFileEntry))</div>
<div class="line"><span class="lineno">  329</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    <span class="comment">// No more files</span></div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a>;</div>
<div class="line"><span class="lineno">  334</span>}</div>
<div class="ttc" id="aSFileFindFile_8cpp_html_aa5e659a791f58689aa8aba2d48e5742f"><div class="ttname"><a href="SFileFindFile_8cpp.html#aa5e659a791f58689aa8aba2d48e5742f">DoMPQSearch_FileEntry</a></div><div class="ttdeci">static bool DoMPQSearch_FileEntry(TMPQSearch *hs, SFILE_FIND_DATA *lpFindFileData, TMPQArchive *ha, TMPQHash *pHashEntry, TFileEntry *pFileEntry)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00206">SFileFindFile.cpp:206</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_aae2b6f26cfc5d09d2fc734947c82aabe"><div class="ttname"><a href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">_TMPQArchive::dwFileTableSize</a></div><div class="ttdeci">DWORD dwFileTableSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00841">StormLib.h:841</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a4a5849b5643afbf764895b09b9282c65_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a4a5849b5643afbf764895b09b9282c65_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ac6f8227ca1a03c0d33807ca279f1ba26" name="ac6f8227ca1a03c0d33807ca279f1ba26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f8227ca1a03c0d33807ca279f1ba26">&#9670;&#160;</a></span>DoMPQSearch_HashTable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> DoMPQSearch_HashTable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00292">292</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  293</span>{</div>
<div class="line"><span class="lineno">  294</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pHashTableEnd = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> + ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#afb1795fbecd5336fe21770ed1f76a33f">pHeader</a>-&gt;<a class="code hl_variable" href="struct__TMPQHeader.html#a67f1869dadee712c8210f77ce69cbfa9">dwHashTableSize</a>;</div>
<div class="line"><span class="lineno">  295</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pHash;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// Parse the file table</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">for</span>(pHash = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> + hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">dwNextIndex</a>; pHash &lt; pHashTableEnd; pHash++)</div>
<div class="line"><span class="lineno">  299</span>    {</div>
<div class="line"><span class="lineno">  300</span>        <span class="comment">// Increment the next index for subsequent search</span></div>
<div class="line"><span class="lineno">  301</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#af7e073e7adf1be6bcc9caa622b96a136">dwNextIndex</a>++;</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>        <span class="comment">// Does this hash table entry point to a proper block table entry?</span></div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="SBaseFileTable_8cpp.html#ae4ad10d103002bf009e4f164516f0d85">IsValidHashEntry</a>(ha, pHash))</div>
<div class="line"><span class="lineno">  305</span>        {</div>
<div class="line"><span class="lineno">  306</span>            <span class="comment">// Check if this file entry should be included in the search result</span></div>
<div class="line"><span class="lineno">  307</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileFindFile_8cpp.html#aa5e659a791f58689aa8aba2d48e5742f">DoMPQSearch_FileEntry</a>(hs, lpFindFileData, ha, pHash, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a> + <a class="code hl_define" href="StormLib_8h.html#af80d1aef7136d7c2c793a30c4048c1d9">MPQ_BLOCK_INDEX</a>(pHash)))</div>
<div class="line"><span class="lineno">  308</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  309</span>        }</div>
<div class="line"><span class="lineno">  310</span>    }</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// No more files</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a>;</div>
<div class="line"><span class="lineno">  314</span>}</div>
<div class="ttc" id="aSBaseFileTable_8cpp_html_ae4ad10d103002bf009e4f164516f0d85"><div class="ttname"><a href="SBaseFileTable_8cpp.html#ae4ad10d103002bf009e4f164516f0d85">IsValidHashEntry</a></div><div class="ttdeci">bool IsValidHashEntry(TMPQArchive *ha, TMPQHash *pHash)</div><div class="ttdef"><b>Definition</b> <a href="SBaseFileTable_8cpp_source.html#l00731">SBaseFileTable.cpp:731</a></div></div>
<div class="ttc" id="aStormLib_8h_html_af80d1aef7136d7c2c793a30c4048c1d9"><div class="ttname"><a href="StormLib_8h.html#af80d1aef7136d7c2c793a30c4048c1d9">MPQ_BLOCK_INDEX</a></div><div class="ttdeci">#define MPQ_BLOCK_INDEX(pHash)</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00264">StormLib.h:264</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_afb1795fbecd5336fe21770ed1f76a33f"><div class="ttname"><a href="struct__TMPQArchive.html#afb1795fbecd5336fe21770ed1f76a33f">_TMPQArchive::pHeader</a></div><div class="ttdeci">TMPQHeader * pHeader</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00829">StormLib.h:829</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html"><div class="ttname"><a href="struct__TMPQHash.html">_TMPQHash</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00619">StormLib.h:620</a></div></div>
<div class="ttc" id="astruct__TMPQHeader_html_a67f1869dadee712c8210f77ce69cbfa9"><div class="ttname"><a href="struct__TMPQHeader.html#a67f1869dadee712c8210f77ce69cbfa9">_TMPQHeader::dwHashTableSize</a></div><div class="ttdeci">DWORD dwHashTableSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00560">StormLib.h:560</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ac6f8227ca1a03c0d33807ca279f1ba26_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ac6f8227ca1a03c0d33807ca279f1ba26_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a6df1af7993593c3d91a62befb3c760ca" name="a6df1af7993593c3d91a62befb3c760ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df1af7993593c3d91a62befb3c760ca">&#9670;&#160;</a></span>FileWasFoundBefore()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> FileWasFoundBefore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *&#160;</td>
          <td class="paramname"><em>pFileEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00113">113</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pEntry;</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">char</span> * szRealFileName = pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>;</div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwStartIndex;</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwNameHash;</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwIndex;</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span>(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a> != NULL &amp;&amp; szRealFileName != NULL)</div>
<div class="line"><span class="lineno">  125</span>    {</div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">// If we are in patch MPQ, we check if patch prefix matches</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">// and then trim the patch prefix</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a> != NULL)</div>
<div class="line"><span class="lineno">  129</span>        {</div>
<div class="line"><span class="lineno">  130</span>            <span class="comment">// If the patch prefix doesn&#39;t fit, we pretend that the file</span></div>
<div class="line"><span class="lineno">  131</span>            <span class="comment">// was there before and it will be skipped</span></div>
<div class="line"><span class="lineno">  132</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="StormPort_8h.html#a42699448fc3b3acbdf9f7bd1f194e9dd">_strnicmp</a>(szRealFileName, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#ae18ce7c7a179a2f3b8c7edfdf1079bb1">szPatchPrefix</a>, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#a9b9249401510b3bf766f8d20e716fd67">nLength</a>))</div>
<div class="line"><span class="lineno">  133</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>            szRealFileName += ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#a9b9249401510b3bf766f8d20e716fd67">nLength</a>;</div>
<div class="line"><span class="lineno">  136</span>        }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>        <span class="comment">// Calculate the hash to the table</span></div>
<div class="line"><span class="lineno">  139</span>        dwNameHash = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a5075170ac14f68563fd5548ad332fe38">pfnHashString</a>(szRealFileName, <a class="code hl_define" href="StormCommon_8h.html#a08f9b471c3381ddeeebb5975faf04df0">MPQ_HASH_NAME_A</a>);</div>
<div class="line"><span class="lineno">  140</span>        dwStartIndex = dwIndex = (dwNameHash % hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">dwSearchTableItems</a>);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">// The file might have been found before</span></div>
<div class="line"><span class="lineno">  143</span>        <span class="comment">// only if this is not the first MPQ being searched</span></div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a6e455bdb9e81a614ed10d954ee846293">haBase</a> != NULL)</div>
<div class="line"><span class="lineno">  145</span>        {</div>
<div class="line"><span class="lineno">  146</span>            <span class="comment">// Enumerate all entries in the search table</span></div>
<div class="line"><span class="lineno">  147</span>            <span class="keywordflow">for</span>(;;)</div>
<div class="line"><span class="lineno">  148</span>            {</div>
<div class="line"><span class="lineno">  149</span>                <span class="comment">// Get the file entry at that position</span></div>
<div class="line"><span class="lineno">  150</span>                pEntry = hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a>[dwIndex];</div>
<div class="line"><span class="lineno">  151</span>                <span class="keywordflow">if</span>(pEntry == NULL)</div>
<div class="line"><span class="lineno">  152</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>                <span class="keywordflow">if</span>(pEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a> != NULL)</div>
<div class="line"><span class="lineno">  155</span>                {</div>
<div class="line"><span class="lineno">  156</span>                    <span class="comment">// Does the name match?</span></div>
<div class="line"><span class="lineno">  157</span>                    <span class="keywordflow">if</span>(!<a class="code hl_define" href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a>(pEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>, szRealFileName))</div>
<div class="line"><span class="lineno">  158</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  159</span>                }</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>                <span class="comment">// Move to the next entry</span></div>
<div class="line"><span class="lineno">  162</span>                dwIndex = (dwIndex + 1) % hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">dwSearchTableItems</a>;</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">if</span>(dwIndex == dwStartIndex)</div>
<div class="line"><span class="lineno">  164</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  165</span>            }</div>
<div class="line"><span class="lineno">  166</span>        }</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        <span class="comment">// Put the entry to the table for later use</span></div>
<div class="line"><span class="lineno">  169</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a>[dwIndex] = pFileEntry;</div>
<div class="line"><span class="lineno">  170</span>    }</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  172</span>}</div>
<div class="ttc" id="aStormCommon_8h_html_a08f9b471c3381ddeeebb5975faf04df0"><div class="ttname"><a href="StormCommon_8h.html#a08f9b471c3381ddeeebb5975faf04df0">MPQ_HASH_NAME_A</a></div><div class="ttdeci">#define MPQ_HASH_NAME_A</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00207">StormCommon.h:207</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a3a35e08b2dedf0975d11794eb8de4805"><div class="ttname"><a href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a></div><div class="ttdeci">#define _stricmp</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00382">StormPort.h:382</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a42699448fc3b3acbdf9f7bd1f194e9dd"><div class="ttname"><a href="StormPort_8h.html#a42699448fc3b3acbdf9f7bd1f194e9dd">_strnicmp</a></div><div class="ttdeci">#define _strnicmp</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00383">StormPort.h:383</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_a8e4185e2ee1a45373adca67a87c39bd5"><div class="ttname"><a href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">TMPQSearch::pSearchTable</a></div><div class="ttdeci">TFileEntry ** pSearchTable</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00022">SFileFindFile.cpp:22</a></div></div>
<div class="ttc" id="astructTMPQSearch_html_ab29741917b722f60e9bbb9c12b4d3f3c"><div class="ttname"><a href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">TMPQSearch::dwSearchTableItems</a></div><div class="ttdeci">DWORD dwSearchTableItems</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00023">SFileFindFile.cpp:23</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a5075170ac14f68563fd5548ad332fe38"><div class="ttname"><a href="struct__TMPQArchive.html#a5075170ac14f68563fd5548ad332fe38">_TMPQArchive::pfnHashString</a></div><div class="ttdeci">HASH_STRING pfnHashString</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00833">StormLib.h:833</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a6e455bdb9e81a614ed10d954ee846293"><div class="ttname"><a href="struct__TMPQArchive.html#a6e455bdb9e81a614ed10d954ee846293">_TMPQArchive::haBase</a></div><div class="ttdeci">struct _TMPQArchive * haBase</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00825">StormLib.h:825</a></div></div>
<div class="ttc" id="astruct__TMPQNamePrefix_html_ae18ce7c7a179a2f3b8c7edfdf1079bb1"><div class="ttname"><a href="struct__TMPQNamePrefix.html#ae18ce7c7a179a2f3b8c7edfdf1079bb1">_TMPQNamePrefix::szPatchPrefix</a></div><div class="ttdeci">char szPatchPrefix[1]</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00799">StormLib.h:799</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a6df1af7993593c3d91a62befb3c760ca_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="abe2bb0b5130da0c25ecbcc8417fe1aae" name="abe2bb0b5130da0c25ecbcc8417fe1aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe2bb0b5130da0c25ecbcc8417fe1aae">&#9670;&#160;</a></span>FindPatchEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> * FindPatchEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a07781c6d52e586d0221f86c84211ab71">TFileEntry</a> *&#160;</td>
          <td class="paramname"><em>pFileEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00174">174</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>{</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pPatchEntry = pFileEntry;</div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pTempEntry;</div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordtype">char</span> szFileName[<a class="code hl_define" href="StormPort_8h.html#ab99ded389af74001a6298fc9e44e74e5">MAX_PATH</a>+1];</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="comment">// Can&#39;t find patch entry for a file that doesn&#39;t have name</span></div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span>(pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a> != NULL &amp;&amp; pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>[0] != 0)</div>
<div class="line"><span class="lineno">  182</span>    {</div>
<div class="line"><span class="lineno">  183</span>        <span class="comment">// Go while there are patches</span></div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">while</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a> != NULL)</div>
<div class="line"><span class="lineno">  185</span>        {</div>
<div class="line"><span class="lineno">  186</span>            <span class="comment">// Move to the patch archive</span></div>
<div class="line"><span class="lineno">  187</span>            ha = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a>;</div>
<div class="line"><span class="lineno">  188</span>            szFileName[0] = 0;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>            <span class="comment">// Prepare the prefix for the file name</span></div>
<div class="line"><span class="lineno">  191</span>            <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a> &amp;&amp; ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#a9b9249401510b3bf766f8d20e716fd67">nLength</a>)</div>
<div class="line"><span class="lineno">  192</span>                <a class="code hl_function" href="SBaseCommon_8cpp.html#ac1750bd8c861039e8dc624fd3e45ebe0">StringCopy</a>(szFileName, <a class="code hl_define" href="StormPort_8h.html#a4987dd6844197a1b6267f4261ae70cf3">_countof</a>(szFileName), ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a751b7e69dec82e5c9657080c8148e5e3">pPatchPrefix</a>-&gt;<a class="code hl_variable" href="struct__TMPQNamePrefix.html#ae18ce7c7a179a2f3b8c7edfdf1079bb1">szPatchPrefix</a>);</div>
<div class="line"><span class="lineno">  193</span>            <a class="code hl_function" href="SBaseCommon_8cpp.html#a10467b63f197e10349f77b1b481efd05">StringCat</a>(szFileName, <a class="code hl_define" href="StormPort_8h.html#a4987dd6844197a1b6267f4261ae70cf3">_countof</a>(szFileName), pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>            <span class="comment">// Try to find the file there</span></div>
<div class="line"><span class="lineno">  196</span>            pTempEntry = <a class="code hl_function" href="SBaseFileTable_8cpp.html#a4a3c55c3fd6bc5e4b5da04a38468d172">GetFileEntryExact</a>(ha, szFileName, 0, NULL);</div>
<div class="line"><span class="lineno">  197</span>            <span class="keywordflow">if</span>(pTempEntry != NULL)</div>
<div class="line"><span class="lineno">  198</span>                pPatchEntry = pTempEntry;</div>
<div class="line"><span class="lineno">  199</span>        }</div>
<div class="line"><span class="lineno">  200</span>    }</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// Return the found patch entry</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">return</span> pPatchEntry;</div>
<div class="line"><span class="lineno">  204</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a10467b63f197e10349f77b1b481efd05"><div class="ttname"><a href="SBaseCommon_8cpp.html#a10467b63f197e10349f77b1b481efd05">StringCat</a></div><div class="ttdeci">void StringCat(char *szTarget, size_t cchTargetMax, const char *szSource)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00118">SBaseCommon.cpp:118</a></div></div>
<div class="ttc" id="aSBaseFileTable_8cpp_html_a4a3c55c3fd6bc5e4b5da04a38468d172"><div class="ttname"><a href="SBaseFileTable_8cpp.html#a4a3c55c3fd6bc5e4b5da04a38468d172">GetFileEntryExact</a></div><div class="ttdeci">TFileEntry * GetFileEntryExact(TMPQArchive *ha, const char *szFileName, LCID lcFileLocale, LPDWORD PtrHashIndex)</div><div class="ttdef"><b>Definition</b> <a href="SBaseFileTable_8cpp_source.html#l02007">SBaseFileTable.cpp:2007</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_abe2bb0b5130da0c25ecbcc8417fe1aae_cgraph.svg" width="100%" height="438"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_abe2bb0b5130da0c25ecbcc8417fe1aae_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ac5b7f1280ba34ac20d05c9bd02d59c22" name="ac5b7f1280ba34ac20d05c9bd02d59c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5b7f1280ba34ac20d05c9bd02d59c22">&#9670;&#160;</a></span>FreeMPQSearch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void FreeMPQSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTMPQSearch.html">TMPQSearch</a> *&amp;&#160;</td>
          <td class="paramname"><em>hs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00369">369</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  370</span>{</div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">if</span>(hs != NULL)</div>
<div class="line"><span class="lineno">  372</span>    {</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">if</span>(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a> != NULL)</div>
<div class="line"><span class="lineno">  374</span>            <a class="code hl_define" href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a>(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a>);</div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_define" href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a>(hs);</div>
<div class="line"><span class="lineno">  376</span>        hs = NULL;</div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>}</div>
<div class="ttc" id="aStormCommon_8h_html_a50487dadfceefebfb0de8fa711eaf4b3"><div class="ttname"><a href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a></div><div class="ttdeci">#define STORM_FREE(ptr)</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00134">StormCommon.h:134</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ac5b7f1280ba34ac20d05c9bd02d59c22_icgraph.svg" width="591" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad20237f9fdc0cdd196e238b09c00e07e" name="ad20237f9fdc0cdd196e238b09c00e07e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20237f9fdc0cdd196e238b09c00e07e">&#9670;&#160;</a></span>GetSearchTableItems()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> GetSearchTableItems </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00095">95</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>{</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwMergeItems = 0;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="comment">// Loop over all patches</span></div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">while</span>(ha != NULL)</div>
<div class="line"><span class="lineno">  101</span>    {</div>
<div class="line"><span class="lineno">  102</span>        <span class="comment">// Append the number of files</span></div>
<div class="line"><span class="lineno">  103</span>        dwMergeItems += (ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a964afcb85acb567a58ef4066b579fd51">pHetTable</a> != NULL) ? ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a964afcb85acb567a58ef4066b579fd51">pHetTable</a>-&gt;<a class="code hl_variable" href="struct__TMPQHetTable.html#a2665ff9c158bcc7c40283f543f25d0ef">dwEntryCount</a></div>
<div class="line"><span class="lineno">  104</span>                                                : ha-&gt;pHeader-&gt;dwBlockTableSize;</div>
<div class="line"><span class="lineno">  105</span>        <span class="comment">// Move to the patched archive</span></div>
<div class="line"><span class="lineno">  106</span>        ha = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a>;</div>
<div class="line"><span class="lineno">  107</span>    }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">// Return the double size of number of items</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">return</span> (dwMergeItems | 1);</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="astruct__TMPQArchive_html_a964afcb85acb567a58ef4066b579fd51"><div class="ttname"><a href="struct__TMPQArchive.html#a964afcb85acb567a58ef4066b579fd51">_TMPQArchive::pHetTable</a></div><div class="ttdeci">TMPQHetTable * pHetTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00831">StormLib.h:831</a></div></div>
<div class="ttc" id="astruct__TMPQHetTable_html_a2665ff9c158bcc7c40283f543f25d0ef"><div class="ttname"><a href="struct__TMPQHetTable.html#a2665ff9c158bcc7c40283f543f25d0ef">_TMPQHetTable::dwEntryCount</a></div><div class="ttdeci">DWORD dwEntryCount</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00762">StormLib.h:762</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ad20237f9fdc0cdd196e238b09c00e07e_icgraph.svg" width="627" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae86cfd67ac2d45b236721b35e2ca1313" name="ae86cfd67ac2d45b236721b35e2ca1313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae86cfd67ac2d45b236721b35e2ca1313">&#9670;&#160;</a></span>IsValidSearchHandle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structTMPQSearch.html">TMPQSearch</a> * IsValidSearchHandle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hFind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00032">32</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> * hs = (<a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> *)hFind;</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">if</span>(hs != NULL &amp;&amp; <a class="code hl_function" href="SBaseCommon_8cpp.html#a8d5000a636535d3a630b1704a9b355e1">IsValidMpqHandle</a>(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">ha</a>))</div>
<div class="line"><span class="lineno">   37</span>        <span class="keywordflow">return</span> hs;</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   40</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a8d5000a636535d3a630b1704a9b355e1"><div class="ttname"><a href="SBaseCommon_8cpp.html#a8d5000a636535d3a630b1704a9b355e1">IsValidMpqHandle</a></div><div class="ttdeci">TMPQArchive * IsValidMpqHandle(HANDLE hMpq)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00709">SBaseCommon.cpp:709</a></div></div>
<div class="ttc" id="astructTMPQSearch_html"><div class="ttname"><a href="structTMPQSearch.html">TMPQSearch</a></div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00019">SFileFindFile.cpp:20</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ae86cfd67ac2d45b236721b35e2ca1313_cgraph.svg" width="352" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_ae86cfd67ac2d45b236721b35e2ca1313_icgraph.svg" width="626" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a73a025a0f97982f04996b923c97ff795" name="a73a025a0f97982f04996b923c97ff795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a025a0f97982f04996b923c97ff795">&#9670;&#160;</a></span>SFileCheckWildCard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> SFileCheckWildCard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szString</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szWildCard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00042">42</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> * szWildCardPtr;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span>(;;)</div>
<div class="line"><span class="lineno">   47</span>    {</div>
<div class="line"><span class="lineno">   48</span>        <span class="comment">// If there is &#39;?&#39; in the wildcard, we skip one char</span></div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">while</span>(szWildCard[0] == <span class="charliteral">&#39;?&#39;</span>)</div>
<div class="line"><span class="lineno">   50</span>        {</div>
<div class="line"><span class="lineno">   51</span>            <span class="keywordflow">if</span>(szString[0] == 0)</div>
<div class="line"><span class="lineno">   52</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>            szWildCard++;</div>
<div class="line"><span class="lineno">   55</span>            szString++;</div>
<div class="line"><span class="lineno">   56</span>        }</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>        <span class="comment">// Handle &#39;*&#39;</span></div>
<div class="line"><span class="lineno">   59</span>        szWildCardPtr = szWildCard;</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">if</span>(szWildCardPtr[0] != 0)</div>
<div class="line"><span class="lineno">   61</span>        {</div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordflow">if</span>(szWildCardPtr[0] == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><span class="lineno">   63</span>            {</div>
<div class="line"><span class="lineno">   64</span>                <span class="keywordflow">while</span>(szWildCardPtr[0] == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><span class="lineno">   65</span>                    szWildCardPtr++;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>                <span class="keywordflow">if</span>(szWildCardPtr[0] == 0)</div>
<div class="line"><span class="lineno">   68</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szWildCardPtr[0]] == <a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szString[0]])</div>
<div class="line"><span class="lineno">   71</span>                {</div>
<div class="line"><span class="lineno">   72</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a>(szString, szWildCardPtr))</div>
<div class="line"><span class="lineno">   73</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   74</span>                }</div>
<div class="line"><span class="lineno">   75</span>            }</div>
<div class="line"><span class="lineno">   76</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   77</span>            {</div>
<div class="line"><span class="lineno">   78</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szWildCardPtr[0]] != <a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szString[0]])</div>
<div class="line"><span class="lineno">   79</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>                szWildCard = szWildCardPtr + 1;</div>
<div class="line"><span class="lineno">   82</span>            }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordflow">if</span>(szString[0] == 0)</div>
<div class="line"><span class="lineno">   85</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   86</span>            szString++;</div>
<div class="line"><span class="lineno">   87</span>        }</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   89</span>        {</div>
<div class="line"><span class="lineno">   90</span>            <span class="keywordflow">return</span> (szString[0] == 0) ? <a class="code hl_define" href="StormPort_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a> : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   91</span>        }</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a5f6fa9d0439a797a0a86c5ee70718390"><div class="ttname"><a href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a></div><div class="ttdeci">unsigned char AsciiToUpperTable[256]</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00055">SBaseCommon.cpp:55</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a41f9c5fb8b08eb5dc3edce4dcb37fee7"><div class="ttname"><a href="StormPort_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></div><div class="ttdeci">#define true</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00032">StormPort.h:32</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a73a025a0f97982f04996b923c97ff795_cgraph.svg" width="163" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a73a025a0f97982f04996b923c97ff795_icgraph.svg" width="100%" height="456"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a33ff6856104b147ef82a90e86699ca15" name="a33ff6856104b147ef82a90e86699ca15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33ff6856104b147ef82a90e86699ca15">&#9670;&#160;</a></span>SFileFindClose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SFileFindClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hFind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00468">468</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>{</div>
<div class="line"><span class="lineno">  470</span>    <a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> * hs = <a class="code hl_function" href="SFileFindFile_8cpp.html#ae86cfd67ac2d45b236721b35e2ca1313">IsValidSearchHandle</a>(hFind);</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">// Check the parameters</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span>(hs == NULL)</div>
<div class="line"><span class="lineno">  474</span>    {</div>
<div class="line"><span class="lineno">  475</span>        <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(<a class="code hl_define" href="StormPort_8h.html#ac5083578cba1fa368ae57edc1b0c6a69">ERROR_INVALID_HANDLE</a>);</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    <a class="code hl_function" href="SFileFindFile_8cpp.html#ac5b7f1280ba34ac20d05c9bd02d59c22">FreeMPQSearch</a>(hs);</div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  481</span>}</div>
<div class="ttc" id="aFileStream_8cpp_html_a65dd8d3e416ffbd6ac5f468c6bdccac9"><div class="ttname"><a href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a></div><div class="ttdeci">void SetLastError(DWORD dwErrCode)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l00049">FileStream.cpp:49</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_ac5b7f1280ba34ac20d05c9bd02d59c22"><div class="ttname"><a href="SFileFindFile_8cpp.html#ac5b7f1280ba34ac20d05c9bd02d59c22">FreeMPQSearch</a></div><div class="ttdeci">static void FreeMPQSearch(TMPQSearch *&amp;hs)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00369">SFileFindFile.cpp:369</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_ae86cfd67ac2d45b236721b35e2ca1313"><div class="ttname"><a href="SFileFindFile_8cpp.html#ae86cfd67ac2d45b236721b35e2ca1313">IsValidSearchHandle</a></div><div class="ttdeci">static TMPQSearch * IsValidSearchHandle(HANDLE hFind)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00032">SFileFindFile.cpp:32</a></div></div>
<div class="ttc" id="aStormPort_8h_html_ac5083578cba1fa368ae57edc1b0c6a69"><div class="ttname"><a href="StormPort_8h.html#ac5083578cba1fa368ae57edc1b0c6a69">ERROR_INVALID_HANDLE</a></div><div class="ttdeci">#define ERROR_INVALID_HANDLE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00404">StormPort.h:404</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a33ff6856104b147ef82a90e86699ca15_cgraph.svg" width="516" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a33ff6856104b147ef82a90e86699ca15_icgraph.svg" width="404" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0d4954b949694dc170b05364c2add5cd" name="a0d4954b949694dc170b05364c2add5cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d4954b949694dc170b05364c2add5cd">&#9670;&#160;</a></span>SFileFindFirstFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SFileFindFirstFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *&#160;</td>
          <td class="paramname"><em>szListFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00383">383</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_struct" href="struct__TMPQArchive.html">TMPQArchive</a> * ha = (<a class="code hl_struct" href="struct__TMPQArchive.html">TMPQArchive</a> *)hMpq;</div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> * hs = NULL;</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordtype">size_t</span> nSize  = 0;</div>
<div class="line"><span class="lineno">  388</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode = <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// Check for the valid parameters</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="SBaseCommon_8cpp.html#a8d5000a636535d3a630b1704a9b355e1">IsValidMpqHandle</a>(hMpq))</div>
<div class="line"><span class="lineno">  392</span>        dwErrCode = <a class="code hl_define" href="StormPort_8h.html#ac5083578cba1fa368ae57edc1b0c6a69">ERROR_INVALID_HANDLE</a>;</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">if</span>(szMask == NULL || lpFindFileData == NULL)</div>
<div class="line"><span class="lineno">  394</span>        dwErrCode = <a class="code hl_define" href="StormPort_8h.html#a176960f93d11db6f58d10a6957a80f38">ERROR_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    <span class="comment">// Include the listfile into the MPQ&#39;s internal listfile</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">// Note that if the listfile name is NULL, do nothing because the</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="comment">// internal listfile is always included.</span></div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a> &amp;&amp; szListFile != NULL &amp;&amp; *szListFile != 0)</div>
<div class="line"><span class="lineno">  400</span>        dwErrCode = <a class="code hl_function" href="SFileListFile_8cpp.html#ab699405208db728f480c491831904e36">SFileAddListFile</a>((<a class="code hl_typedef" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>)ha, szListFile);</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    <span class="comment">// Allocate the structure for MPQ search</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  404</span>    {</div>
<div class="line"><span class="lineno">  405</span>        nSize = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a>) + strlen(szMask) + 1;</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">if</span>((hs = (<a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> *)<a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<span class="keywordtype">char</span>, nSize)) == NULL)</div>
<div class="line"><span class="lineno">  407</span>            dwErrCode = <a class="code hl_define" href="StormPort_8h.html#a0e8ed8133680d2d6b8909e71b8048307">ERROR_NOT_ENOUGH_MEMORY</a>;</div>
<div class="line"><span class="lineno">  408</span>    }</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    <span class="comment">// Perform the first search</span></div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  412</span>    {</div>
<div class="line"><span class="lineno">  413</span>        memset(hs, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a>));</div>
<div class="line"><span class="lineno">  414</span>        strcpy(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab9584a44e0ce7f6bdc530909ed2b8349">szSearchMask</a>, szMask);</div>
<div class="line"><span class="lineno">  415</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ad79b7c9e8e617622f2c3fc8c9f9220f9">dwFlagMask</a> = <a class="code hl_define" href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a>;</div>
<div class="line"><span class="lineno">  416</span>        hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab780ac9f795773523f227d9e7209fa2e">ha</a> = ha;</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>        <span class="comment">// If the archive is patched archive, we have to create a merge table</span></div>
<div class="line"><span class="lineno">  419</span>        <span class="comment">// to prevent files being repeated</span></div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a> != NULL)</div>
<div class="line"><span class="lineno">  421</span>        {</div>
<div class="line"><span class="lineno">  422</span>            hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">dwSearchTableItems</a> = <a class="code hl_function" href="SFileFindFile_8cpp.html#ad20237f9fdc0cdd196e238b09c00e07e">GetSearchTableItems</a>(ha);</div>
<div class="line"><span class="lineno">  423</span>            hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a> = <a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> *, hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">dwSearchTableItems</a>);</div>
<div class="line"><span class="lineno">  424</span>            hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ad79b7c9e8e617622f2c3fc8c9f9220f9">dwFlagMask</a> = <a class="code hl_define" href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a> | <a class="code hl_define" href="StormLib_8h.html#a437c4920546d0e3e3a7a4e040e9aef20">MPQ_FILE_PATCH_FILE</a>;</div>
<div class="line"><span class="lineno">  425</span>            <span class="keywordflow">if</span>(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a> != NULL)</div>
<div class="line"><span class="lineno">  426</span>                memset(hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#a8e4185e2ee1a45373adca67a87c39bd5">pSearchTable</a>, 0, hs-&gt;<a class="code hl_variable" href="structTMPQSearch.html#ab29741917b722f60e9bbb9c12b4d3f3c">dwSearchTableItems</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> *));</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  428</span>                dwErrCode = <a class="code hl_define" href="StormPort_8h.html#a0e8ed8133680d2d6b8909e71b8048307">ERROR_NOT_ENOUGH_MEMORY</a>;</div>
<div class="line"><span class="lineno">  429</span>        }</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">// Perform first item searching</span></div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  434</span>    {</div>
<div class="line"><span class="lineno">  435</span>        dwErrCode = <a class="code hl_function" href="SFileFindFile_8cpp.html#acc4812686674104aa8e2938531cf2111">DoMPQSearch</a>(hs, lpFindFileData);</div>
<div class="line"><span class="lineno">  436</span>    }</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    <span class="comment">// Cleanup</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">if</span>(dwErrCode != <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  440</span>    {</div>
<div class="line"><span class="lineno">  441</span>        <a class="code hl_function" href="SFileFindFile_8cpp.html#ac5b7f1280ba34ac20d05c9bd02d59c22">FreeMPQSearch</a>(hs);</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(dwErrCode);</div>
<div class="line"><span class="lineno">  443</span>    }</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <span class="comment">// Return the result value</span></div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">return</span> (<a class="code hl_typedef" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>)hs;</div>
<div class="line"><span class="lineno">  447</span>}</div>
<div class="ttc" id="aSFileFindFile_8cpp_html_acc4812686674104aa8e2938531cf2111"><div class="ttname"><a href="SFileFindFile_8cpp.html#acc4812686674104aa8e2938531cf2111">DoMPQSearch</a></div><div class="ttdeci">static DWORD DoMPQSearch(TMPQSearch *hs, SFILE_FIND_DATA *lpFindFileData)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00337">SFileFindFile.cpp:337</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_ad20237f9fdc0cdd196e238b09c00e07e"><div class="ttname"><a href="SFileFindFile_8cpp.html#ad20237f9fdc0cdd196e238b09c00e07e">GetSearchTableItems</a></div><div class="ttdeci">static DWORD GetSearchTableItems(TMPQArchive *ha)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00095">SFileFindFile.cpp:95</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_ab699405208db728f480c491831904e36"><div class="ttname"><a href="SFileListFile_8cpp.html#ab699405208db728f480c491831904e36">SFileAddListFile</a></div><div class="ttdeci">DWORD WINAPI SFileAddListFile(HANDLE hMpq, const TCHAR *szListFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00639">SFileListFile.cpp:639</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a6fe0c42173ef1a4b9f0e837b0c631660"><div class="ttname"><a href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a></div><div class="ttdeci">#define STORM_ALLOC(type, nitems)</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00132">StormCommon.h:132</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a437c4920546d0e3e3a7a4e040e9aef20"><div class="ttname"><a href="StormLib_8h.html#a437c4920546d0e3e3a7a4e040e9aef20">MPQ_FILE_PATCH_FILE</a></div><div class="ttdeci">#define MPQ_FILE_PATCH_FILE</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00220">StormLib.h:220</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a0e8ed8133680d2d6b8909e71b8048307"><div class="ttname"><a href="StormPort_8h.html#a0e8ed8133680d2d6b8909e71b8048307">ERROR_NOT_ENOUGH_MEMORY</a></div><div class="ttdeci">#define ERROR_NOT_ENOUGH_MEMORY</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00405">StormPort.h:405</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a176960f93d11db6f58d10a6957a80f38"><div class="ttname"><a href="StormPort_8h.html#a176960f93d11db6f58d10a6957a80f38">ERROR_INVALID_PARAMETER</a></div><div class="ttdeci">#define ERROR_INVALID_PARAMETER</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00407">StormPort.h:407</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a0d4954b949694dc170b05364c2add5cd_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a0d4954b949694dc170b05364c2add5cd_icgraph.svg" width="419" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9a04c684ebc812ab085d9615d1bce183" name="a9a04c684ebc812ab085d9615d1bce183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a04c684ebc812ab085d9615d1bce183">&#9670;&#160;</a></span>SFileFindNextFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SFileFindNextFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hFind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00449">449</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span>{</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_struct" href="structTMPQSearch.html">TMPQSearch</a> * hs = <a class="code hl_function" href="SFileFindFile_8cpp.html#ae86cfd67ac2d45b236721b35e2ca1313">IsValidSearchHandle</a>(hFind);</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode = <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">// Check the parameters</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span>(hs == NULL)</div>
<div class="line"><span class="lineno">  456</span>        dwErrCode = <a class="code hl_define" href="StormPort_8h.html#ac5083578cba1fa368ae57edc1b0c6a69">ERROR_INVALID_HANDLE</a>;</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">if</span>(lpFindFileData == NULL)</div>
<div class="line"><span class="lineno">  458</span>        dwErrCode = <a class="code hl_define" href="StormPort_8h.html#a176960f93d11db6f58d10a6957a80f38">ERROR_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  461</span>        dwErrCode = <a class="code hl_function" href="SFileFindFile_8cpp.html#acc4812686674104aa8e2938531cf2111">DoMPQSearch</a>(hs, lpFindFileData);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">if</span>(dwErrCode != <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  464</span>        <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(dwErrCode);</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span> (dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  466</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a9a04c684ebc812ab085d9615d1bce183_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileFindFile_8cpp_a9a04c684ebc812ab085d9615d1bce183_icgraph.svg" width="423" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a65adb78194d8b06ca6fd510af8357a.html">AscEmu</a></li><li class="navelem"><a class="el" href="dir_d0fc04153d74feb886fd2096a57dc87f.html">dep</a></li><li class="navelem"><a class="el" href="dir_2594a7fc2f53d73154bdbd3e3b1986ef.html">StormLib</a></li><li class="navelem"><a class="el" href="dir_77224f19d90cfc88aa172a2cc692c112.html">src</a></li><li class="navelem"><a class="el" href="SFileFindFile_8cpp.html">SFileFindFile.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
