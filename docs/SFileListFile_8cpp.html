<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AscEmu: AscEmu/dep/StormLib/src/SFileListFile.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="AscEmu.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AscEmu
   </div>
   <div id="projectbrief">OpenSource WoW Emulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SFileListFile_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">SFileListFile.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="StormLib_8h_source.html">StormLib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="StormCommon_8h_source.html">StormCommon.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SFileListFile.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp__incl.svg" width="100%" height="569"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp__dep__incl.svg" width="196" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="SFileListFile_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionTListFileHandle.html">TListFileHandle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTListFileCache.html">TListFileCache</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6c6f05f604e9e3c9c3536365c5f81665" id="r_a6c6f05f604e9e3c9c3536365c5f81665"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a6c6f05f604e9e3c9c3536365c5f81665">__STORMLIB_SELF__</a></td></tr>
<tr class="separator:a6c6f05f604e9e3c9c3536365c5f81665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8079a9bd4913185cc86bab2a14f3d3e" id="r_af8079a9bd4913185cc86bab2a14f3d3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#af8079a9bd4913185cc86bab2a14f3d3e">CACHE_BUFFER_SIZE</a>&#160;&#160;&#160;0x1000</td></tr>
<tr class="separator:af8079a9bd4913185cc86bab2a14f3d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ca63d621208bf3a7919ed605ee6cdd3" id="r_a0ca63d621208bf3a7919ed605ee6cdd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a0ca63d621208bf3a7919ed605ee6cdd3">MAX_LISTFILE_SIZE</a>&#160;&#160;&#160;0x8000000</td></tr>
<tr class="separator:a0ca63d621208bf3a7919ed605ee6cdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad3e471dd32b926b82b31c1a89abe4801" id="r_ad3e471dd32b926b82b31c1a89abe4801"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#ad3e471dd32b926b82b31c1a89abe4801">LOAD_LISTFILE</a>) (<a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *pHandle, void *pvBuffer, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> cbBuffer, <a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a> pdwBytesRead)</td></tr>
<tr class="separator:ad3e471dd32b926b82b31c1a89abe4801"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a73a025a0f97982f04996b923c97ff795" id="r_a73a025a0f97982f04996b923c97ff795"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a> (<a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szString, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szWildCard)</td></tr>
<tr class="separator:a73a025a0f97982f04996b923c97ff795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdbf3b7e5acf256c444e0a7aa6fd299b" id="r_afdbf3b7e5acf256c444e0a7aa6fd299b"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#afdbf3b7e5acf256c444e0a7aa6fd299b">CopyListLine</a> (char *szListLine, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szFileName)</td></tr>
<tr class="separator:afdbf3b7e5acf256c444e0a7aa6fd299b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e924aff77033ed1f2a32022a09a7b0f" id="r_a9e924aff77033ed1f2a32022a09a7b0f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a9e924aff77033ed1f2a32022a09a7b0f">LoadListFile_Stream</a> (<a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *pHandle, void *pvBuffer, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> cbBuffer, <a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a> pdwBytesRead)</td></tr>
<tr class="separator:a9e924aff77033ed1f2a32022a09a7b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785a7726363d009ad01d100b4d7cfd56" id="r_a785a7726363d009ad01d100b4d7cfd56"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a785a7726363d009ad01d100b4d7cfd56">LoadListFile_MPQ</a> (<a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *pHandle, void *pvBuffer, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> cbBuffer, <a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a> pdwBytesRead)</td></tr>
<tr class="separator:a785a7726363d009ad01d100b4d7cfd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe247b168feddf4764a34c901353b65e" id="r_abe247b168feddf4764a34c901353b65e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a> (<a class="el" href="structTListFileCache.html">TListFileCache</a> *pCache)</td></tr>
<tr class="separator:abe247b168feddf4764a34c901353b65e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d96cb819377f37c1632337009d6f52" id="r_a19d96cb819377f37c1632337009d6f52"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structTListFileCache.html">TListFileCache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a> (<a class="el" href="SFileListFile_8cpp.html#ad3e471dd32b926b82b31c1a89abe4801">LOAD_LISTFILE</a> PfnLoadFile, <a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *pHandle, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szWildCard, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwFileSize, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwMaxSize, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwFlags)</td></tr>
<tr class="separator:a19d96cb819377f37c1632337009d6f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6195145d2c2de3dd2f73fd4d21b7c351" id="r_a6195145d2c2de3dd2f73fd4d21b7c351"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structTListFileCache.html">TListFileCache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a6195145d2c2de3dd2f73fd4d21b7c351">CreateListFileCache</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *szListFile, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szWildCard, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwMaxSize, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwFlags)</td></tr>
<tr class="separator:a6195145d2c2de3dd2f73fd4d21b7c351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa3440d25147e9668c5ee97d079ce859" id="r_aaa3440d25147e9668c5ee97d079ce859"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#aaa3440d25147e9668c5ee97d079ce859">ReadListFileLine</a> (<a class="el" href="structTListFileCache.html">TListFileCache</a> *pCache, size_t *PtrLength)</td></tr>
<tr class="separator:aaa3440d25147e9668c5ee97d079ce859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c05897f8efe909b55a659f4367129cf" id="r_a5c05897f8efe909b55a659f4367129cf"><td class="memItemLeft" align="right" valign="top">static int <a class="el" href="StormPort_8h.html#a681624373493546019fb4c31c830ffff">STORMLIB_CDECL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a5c05897f8efe909b55a659f4367129cf">CompareFileNodes</a> (<a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *p1, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *p2)</td></tr>
<tr class="separator:a5c05897f8efe909b55a659f4367129cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d14a643cddff424c694883ca753659" id="r_ad4d14a643cddff424c694883ca753659"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#ad4d14a643cddff424c694883ca753659">CreateListFile</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> *pcbListFile)</td></tr>
<tr class="separator:ad4d14a643cddff424c694883ca753659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28970c3b2769a1db546e497b138e2034" id="r_a28970c3b2769a1db546e497b138e2034"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szFileName)</td></tr>
<tr class="separator:a28970c3b2769a1db546e497b138e2034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3a5effd18cd4d2e541c23e87f4c52ea" id="r_ae3a5effd18cd4d2e541c23e87f4c52ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#ae3a5effd18cd4d2e541c23e87f4c52ea">SListFileSaveToMpq</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha)</td></tr>
<tr class="separator:ae3a5effd18cd4d2e541c23e87f4c52ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f0f70ba9f777b1ba98546d16484070" id="r_aa5f0f70ba9f777b1ba98546d16484070"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#aa5f0f70ba9f777b1ba98546d16484070">SFileAddArbitraryListFile</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *szListFile, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwMaxSize)</td></tr>
<tr class="separator:aa5f0f70ba9f777b1ba98546d16484070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8880b420fb6890e6d2ae8cc56fdc7e7" id="r_ab8880b420fb6890e6d2ae8cc56fdc7e7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#ab8880b420fb6890e6d2ae8cc56fdc7e7">SFileAddInternalListFile</a> (<a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *ha, <a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq)</td></tr>
<tr class="separator:ab8880b420fb6890e6d2ae8cc56fdc7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29315b5c89f4ff1691be43e6cc5b8eb0" id="r_a29315b5c89f4ff1691be43e6cc5b8eb0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a29315b5c89f4ff1691be43e6cc5b8eb0">DoListFileSearch</a> (<a class="el" href="structTListFileCache.html">TListFileCache</a> *pCache, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData)</td></tr>
<tr class="separator:a29315b5c89f4ff1691be43e6cc5b8eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab699405208db728f480c491831904e36" id="r_ab699405208db728f480c491831904e36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#ab699405208db728f480c491831904e36">SFileAddListFile</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *szListFile)</td></tr>
<tr class="separator:ab699405208db728f480c491831904e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba1c9038ee83a8240402172dbab5ff30" id="r_aba1c9038ee83a8240402172dbab5ff30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#aba1c9038ee83a8240402172dbab5ff30">SListFileFindFirstFile</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hMpq, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *szListFile, <a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *szMask, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData)</td></tr>
<tr class="separator:aba1c9038ee83a8240402172dbab5ff30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391fb032f484224b1aa8989663f9357a" id="r_a391fb032f484224b1aa8989663f9357a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a391fb032f484224b1aa8989663f9357a">SListFileFindNextFile</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFind, <a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *lpFindFileData)</td></tr>
<tr class="separator:a391fb032f484224b1aa8989663f9357a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9b409ac37f567dd42aed8be7dee6eb" id="r_a7c9b409ac37f567dd42aed8be7dee6eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SFileListFile_8cpp.html#a7c9b409ac37f567dd42aed8be7dee6eb">SListFileFindClose</a> (<a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> hFind)</td></tr>
<tr class="separator:a7c9b409ac37f567dd42aed8be7dee6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6c6f05f604e9e3c9c3536365c5f81665" name="a6c6f05f604e9e3c9c3536365c5f81665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6f05f604e9e3c9c3536365c5f81665">&#9670;&#160;</a></span>__STORMLIB_SELF__</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __STORMLIB_SELF__</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00011">11</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>

</div>
</div>
<a id="af8079a9bd4913185cc86bab2a14f3d3e" name="af8079a9bd4913185cc86bab2a14f3d3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8079a9bd4913185cc86bab2a14f3d3e">&#9670;&#160;</a></span>CACHE_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CACHE_BUFFER_SIZE&#160;&#160;&#160;0x1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00019">19</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>

</div>
</div>
<a id="a0ca63d621208bf3a7919ed605ee6cdd3" name="a0ca63d621208bf3a7919ed605ee6cdd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca63d621208bf3a7919ed605ee6cdd3">&#9670;&#160;</a></span>MAX_LISTFILE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_LISTFILE_SIZE&#160;&#160;&#160;0x8000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00020">20</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ad3e471dd32b926b82b31c1a89abe4801" name="ad3e471dd32b926b82b31c1a89abe4801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e471dd32b926b82b31c1a89abe4801">&#9670;&#160;</a></span>LOAD_LISTFILE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>(* LOAD_LISTFILE) (<a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *pHandle, void *pvBuffer, <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> cbBuffer, <a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a> pdwBytesRead)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00040">40</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5c05897f8efe909b55a659f4367129cf" name="a5c05897f8efe909b55a659f4367129cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c05897f8efe909b55a659f4367129cf">&#9670;&#160;</a></span>CompareFileNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int <a class="el" href="StormPort_8h.html#a681624373493546019fb4c31c830ffff">STORMLIB_CDECL</a> CompareFileNodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00303">303</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  304</span>{</div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordtype">char</span> * szFileName1 = *(<span class="keywordtype">char</span> **)p1;</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordtype">char</span> * szFileName2 = *(<span class="keywordtype">char</span> **)p2;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a>(szFileName1, szFileName2);</div>
<div class="line"><span class="lineno">  309</span>}</div>
<div class="ttc" id="aStormPort_8h_html_a3a35e08b2dedf0975d11794eb8de4805"><div class="ttname"><a href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a></div><div class="ttdeci">#define _stricmp</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00382">StormPort.h:382</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a5c05897f8efe909b55a659f4367129cf_icgraph.svg" width="100%" height="477"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="afdbf3b7e5acf256c444e0a7aa6fd299b" name="afdbf3b7e5acf256c444e0a7aa6fd299b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdbf3b7e5acf256c444e0a7aa6fd299b">&#9670;&#160;</a></span>CopyListLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * CopyListLine </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>szListLine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szFileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00048">48</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>{</div>
<div class="line"><span class="lineno">   50</span>    <span class="comment">// Copy the string</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">while</span>(szFileName[0] != 0)</div>
<div class="line"><span class="lineno">   52</span>        *szListLine++ = *szFileName++;</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">// Append the end-of-line</span></div>
<div class="line"><span class="lineno">   55</span>    *szListLine++ = 0x0D;</div>
<div class="line"><span class="lineno">   56</span>    *szListLine++ = 0x0A;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">return</span> szListLine;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_afdbf3b7e5acf256c444e0a7aa6fd299b_icgraph.svg" width="100%" height="477"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ad4d14a643cddff424c694883ca753659" name="ad4d14a643cddff424c694883ca753659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d14a643cddff424c694883ca753659">&#9670;&#160;</a></span>CreateListFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a> CreateListFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> *&#160;</td>
          <td class="paramname"><em>pcbListFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00311">311</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  312</span>{</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pFileTableEnd = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a> + ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">dwFileTableSize</a>;</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pFileEntry;</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordtype">char</span> ** SortTable = NULL;</div>
<div class="line"><span class="lineno">  316</span>    <span class="keywordtype">char</span> * szListFile = NULL;</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordtype">char</span> * szListLine;</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordtype">size_t</span> nFileNodes = 0;</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordtype">size_t</span> cbListFile = 0;</div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordtype">size_t</span> nIndex0;</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordtype">size_t</span> nIndex1;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="comment">// Allocate the table for sorting listfile</span></div>
<div class="line"><span class="lineno">  324</span>    SortTable = <a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<span class="keywordtype">char</span>*, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">dwFileTableSize</a>);</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">if</span>(SortTable == NULL)</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">// Construct the sort table</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="comment">// Note: in MPQs with multiple locale versions of the same file,</span></div>
<div class="line"><span class="lineno">  330</span>    <span class="comment">// this code causes adding multiple listfile entries.</span></div>
<div class="line"><span class="lineno">  331</span>    <span class="comment">// They will get removed after the listfile sorting</span></div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">for</span>(pFileEntry = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a>; pFileEntry &lt; pFileTableEnd; pFileEntry++)</div>
<div class="line"><span class="lineno">  333</span>    {</div>
<div class="line"><span class="lineno">  334</span>        <span class="comment">// Only take existing items</span></div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordflow">if</span>((pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">dwFlags</a> &amp; <a class="code hl_define" href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a>) &amp;&amp; pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a> != NULL)</div>
<div class="line"><span class="lineno">  336</span>        {</div>
<div class="line"><span class="lineno">  337</span>            <span class="comment">// Ignore pseudo-names and internal names</span></div>
<div class="line"><span class="lineno">  338</span>            <span class="keywordflow">if</span>(!<a class="code hl_function" href="SBaseCommon_8cpp.html#ad01c4c290fa6caebc77053dbc12c1070">IsPseudoFileName</a>(pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>, NULL) &amp;&amp; !<a class="code hl_function" href="SBaseCommon_8cpp.html#a271822a4e6a88edb8f2f53df8b713023">IsInternalMpqFileName</a>(pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>))</div>
<div class="line"><span class="lineno">  339</span>            {</div>
<div class="line"><span class="lineno">  340</span>                SortTable[nFileNodes++] = pFileEntry-&gt;<a class="code hl_variable" href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">szFileName</a>;</div>
<div class="line"><span class="lineno">  341</span>            }</div>
<div class="line"><span class="lineno">  342</span>        }</div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">// Remove duplicities</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span>(nFileNodes &gt; 0)</div>
<div class="line"><span class="lineno">  347</span>    {</div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">// Sort the table</span></div>
<div class="line"><span class="lineno">  349</span>        qsort(SortTable, nFileNodes, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *), <a class="code hl_function" href="SFileListFile_8cpp.html#a5c05897f8efe909b55a659f4367129cf">CompareFileNodes</a>);</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>        <span class="comment">// Count the 0-th item</span></div>
<div class="line"><span class="lineno">  352</span>        cbListFile += strlen(SortTable[0]) + 2;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>        <span class="comment">// Walk through the items and only use the ones that are not duplicated</span></div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">for</span>(nIndex0 = 0, nIndex1 = 1; nIndex1 &lt; nFileNodes; nIndex1++)</div>
<div class="line"><span class="lineno">  356</span>        {</div>
<div class="line"><span class="lineno">  357</span>            <span class="comment">// If the next file node is different, we will include it to the result listfile</span></div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a>(SortTable[nIndex1], SortTable[nIndex0]) != 0)</div>
<div class="line"><span class="lineno">  359</span>            {</div>
<div class="line"><span class="lineno">  360</span>                cbListFile += strlen(SortTable[nIndex1]) + 2;</div>
<div class="line"><span class="lineno">  361</span>                nIndex0 = nIndex1;</div>
<div class="line"><span class="lineno">  362</span>            }</div>
<div class="line"><span class="lineno">  363</span>        }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>        <span class="comment">// Now allocate buffer for the entire listfile</span></div>
<div class="line"><span class="lineno">  366</span>        szListFile = szListLine = <a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<span class="keywordtype">char</span>, cbListFile + 1);</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">if</span>(szListFile != NULL)</div>
<div class="line"><span class="lineno">  368</span>        {</div>
<div class="line"><span class="lineno">  369</span>            <span class="comment">// Copy the 0-th item</span></div>
<div class="line"><span class="lineno">  370</span>            szListLine = <a class="code hl_function" href="SFileListFile_8cpp.html#afdbf3b7e5acf256c444e0a7aa6fd299b">CopyListLine</a>(szListLine, SortTable[0]);</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>            <span class="comment">// Walk through the items and only use the ones that are not duplicated</span></div>
<div class="line"><span class="lineno">  373</span>            <span class="keywordflow">for</span>(nIndex0 = 0, nIndex1 = 1; nIndex1 &lt; nFileNodes; nIndex1++)</div>
<div class="line"><span class="lineno">  374</span>            {</div>
<div class="line"><span class="lineno">  375</span>                <span class="comment">// If the next file node is different, we will include it to the result listfile</span></div>
<div class="line"><span class="lineno">  376</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="StormPort_8h.html#a3a35e08b2dedf0975d11794eb8de4805">_stricmp</a>(SortTable[nIndex1], SortTable[nIndex0]) != 0)</div>
<div class="line"><span class="lineno">  377</span>                {</div>
<div class="line"><span class="lineno">  378</span>                    <span class="comment">// Copy the listfile line</span></div>
<div class="line"><span class="lineno">  379</span>                    szListLine = <a class="code hl_function" href="SFileListFile_8cpp.html#afdbf3b7e5acf256c444e0a7aa6fd299b">CopyListLine</a>(szListLine, SortTable[nIndex1]);</div>
<div class="line"><span class="lineno">  380</span>                    nIndex0 = nIndex1;</div>
<div class="line"><span class="lineno">  381</span>                }</div>
<div class="line"><span class="lineno">  382</span>            }</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>            <span class="comment">// Sanity check - does the size match?</span></div>
<div class="line"><span class="lineno">  385</span>            assert((<span class="keywordtype">size_t</span>)(szListLine - szListFile) == cbListFile);</div>
<div class="line"><span class="lineno">  386</span>        }</div>
<div class="line"><span class="lineno">  387</span>    }</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  389</span>    {</div>
<div class="line"><span class="lineno">  390</span>        szListFile = <a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<span class="keywordtype">char</span>, 1);</div>
<div class="line"><span class="lineno">  391</span>        cbListFile = 0;</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">// Free the sort table</span></div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_define" href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a>(SortTable);</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">// Give away the listfile</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span>(pcbListFile != NULL)</div>
<div class="line"><span class="lineno">  399</span>        *pcbListFile = (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)cbListFile;</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">return</span> (<a class="code hl_typedef" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a>)szListFile;</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a271822a4e6a88edb8f2f53df8b713023"><div class="ttname"><a href="SBaseCommon_8cpp.html#a271822a4e6a88edb8f2f53df8b713023">IsInternalMpqFileName</a></div><div class="ttdeci">bool IsInternalMpqFileName(const char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l01738">SBaseCommon.cpp:1738</a></div></div>
<div class="ttc" id="aSBaseCommon_8cpp_html_ad01c4c290fa6caebc77053dbc12c1070"><div class="ttname"><a href="SBaseCommon_8cpp.html#ad01c4c290fa6caebc77053dbc12c1070">IsPseudoFileName</a></div><div class="ttdeci">bool IsPseudoFileName(const char *szFileName, DWORD *pdwFileIndex)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l01754">SBaseCommon.cpp:1754</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_a5c05897f8efe909b55a659f4367129cf"><div class="ttname"><a href="SFileListFile_8cpp.html#a5c05897f8efe909b55a659f4367129cf">CompareFileNodes</a></div><div class="ttdeci">static int STORMLIB_CDECL CompareFileNodes(const void *p1, const void *p2)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00303">SFileListFile.cpp:303</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_afdbf3b7e5acf256c444e0a7aa6fd299b"><div class="ttname"><a href="SFileListFile_8cpp.html#afdbf3b7e5acf256c444e0a7aa6fd299b">CopyListLine</a></div><div class="ttdeci">static char * CopyListLine(char *szListLine, const char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00048">SFileListFile.cpp:48</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a50487dadfceefebfb0de8fa711eaf4b3"><div class="ttname"><a href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a></div><div class="ttdeci">#define STORM_FREE(ptr)</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00134">StormCommon.h:134</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a6fe0c42173ef1a4b9f0e837b0c631660"><div class="ttname"><a href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a></div><div class="ttdeci">#define STORM_ALLOC(type, nitems)</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00132">StormCommon.h:132</a></div></div>
<div class="ttc" id="aStormLib_8h_html_af6f21d7e58bf7855583c8f9667467432"><div class="ttname"><a href="StormLib_8h.html#af6f21d7e58bf7855583c8f9667467432">MPQ_FILE_EXISTS</a></div><div class="ttdeci">#define MPQ_FILE_EXISTS</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00226">StormLib.h:226</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a798af1e30bc65f319c1a246cecf59e39"><div class="ttname"><a href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a></div><div class="ttdeci">unsigned int DWORD</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00336">StormPort.h:336</a></div></div>
<div class="ttc" id="aStormPort_8h_html_ac2d3fb16b5b34c1e6ab80014309020eb"><div class="ttname"><a href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a></div><div class="ttdeci">BYTE * LPBYTE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00348">StormPort.h:348</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html"><div class="ttname"><a href="struct__TFileEntry.html">_TFileEntry</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00686">StormLib.h:687</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_aa00a675cf553d128b1e3b5fdd9cdca0e"><div class="ttname"><a href="struct__TFileEntry.html#aa00a675cf553d128b1e3b5fdd9cdca0e">_TFileEntry::szFileName</a></div><div class="ttdeci">char * szFileName</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00696">StormLib.h:696</a></div></div>
<div class="ttc" id="astruct__TFileEntry_html_aac45e6e4f80c412a0204abd334bc7f9b"><div class="ttname"><a href="struct__TFileEntry.html#aac45e6e4f80c412a0204abd334bc7f9b">_TFileEntry::dwFlags</a></div><div class="ttdeci">DWORD dwFlags</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00693">StormLib.h:693</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a82a7283606d9775df50cb1c683280db1"><div class="ttname"><a href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">_TMPQArchive::pFileTable</a></div><div class="ttdeci">TFileEntry * pFileTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00832">StormLib.h:832</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_aae2b6f26cfc5d09d2fc734947c82aabe"><div class="ttname"><a href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">_TMPQArchive::dwFileTableSize</a></div><div class="ttdeci">DWORD dwFileTableSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00841">StormLib.h:841</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ad4d14a643cddff424c694883ca753659_cgraph.svg" width="343" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ad4d14a643cddff424c694883ca753659_icgraph.svg" width="100%" height="477"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a6195145d2c2de3dd2f73fd4d21b7c351" name="a6195145d2c2de3dd2f73fd4d21b7c351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6195145d2c2de3dd2f73fd4d21b7c351">&#9670;&#160;</a></span>CreateListFileCache() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structTListFileCache.html">TListFileCache</a> * CreateListFileCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *&#160;</td>
          <td class="paramname"><em>szListFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szWildCard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwMaxSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00145">145</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>{</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> * pCache = NULL;</div>
<div class="line"><span class="lineno">  153</span>    <a class="code hl_union" href="unionTListFileHandle.html">TListFileHandle</a> ListHandle = {NULL};</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">// Put default value to dwMaxSize</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span>(dwMaxSize == 0)</div>
<div class="line"><span class="lineno">  157</span>        dwMaxSize = <a class="code hl_define" href="SFileListFile_8cpp.html#a0ca63d621208bf3a7919ed605ee6cdd3">MAX_LISTFILE_SIZE</a>;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">// Internal listfile: hMPQ must be non NULL and szListFile must be NULL.</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="comment">// We load the MPQ::(listfile) file</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">if</span>(hMpq != NULL &amp;&amp; szListFile == NULL)</div>
<div class="line"><span class="lineno">  162</span>    {</div>
<div class="line"><span class="lineno">  163</span>        <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwFileSize = 0;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>        <span class="comment">// Open the file from the MPQ</span></div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileOpenFileEx_8cpp.html#a0049c66b1dbb981f5b69afe6bbe60313">SFileOpenFileEx</a>(hMpq, <a class="code hl_define" href="StormLib_8h.html#ac797c1c425d999b5bc992e2e39b4169e">LISTFILE_NAME</a>, 0, &amp;ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a3db406ed0aabe7b8f732649a78e8d065">hFile</a>))</div>
<div class="line"><span class="lineno">  167</span>        {</div>
<div class="line"><span class="lineno">  168</span>            <span class="comment">// Get the file size and create the listfile cache</span></div>
<div class="line"><span class="lineno">  169</span>            dwFileSize = <a class="code hl_function" href="SFileReadFile_8cpp.html#a1d30c5a49fb9c1c1669884646282e4d3">SFileGetFileSize</a>(ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a3db406ed0aabe7b8f732649a78e8d065">hFile</a>, NULL);</div>
<div class="line"><span class="lineno">  170</span>            pCache = <a class="code hl_function" href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a>(<a class="code hl_function" href="SFileListFile_8cpp.html#a785a7726363d009ad01d100b4d7cfd56">LoadListFile_MPQ</a>, &amp;ListHandle, szWildCard, dwFileSize, dwMaxSize, dwFlags);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>            <span class="comment">// Close the MPQ file</span></div>
<div class="line"><span class="lineno">  173</span>            <a class="code hl_function" href="SFileOpenFileEx_8cpp.html#a49a09a38e6dc3b1afd95163a1c9052c6">SFileCloseFile</a>(ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a3db406ed0aabe7b8f732649a78e8d065">hFile</a>);</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>        <span class="comment">// Return the loaded cache</span></div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">return</span> pCache;</div>
<div class="line"><span class="lineno">  178</span>    }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="comment">// External listfile: hMpq must be NULL and szListFile must be non-NULL.</span></div>
<div class="line"><span class="lineno">  181</span>    <span class="comment">// We load the file using TFileStream</span></div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span>(hMpq == NULL &amp;&amp; szListFile != NULL)</div>
<div class="line"><span class="lineno">  183</span>    {</div>
<div class="line"><span class="lineno">  184</span>        <a class="code hl_typedef" href="StormPort_8h.html#abb9abb9ce956f1a9e5a4081ac40e5649">ULONGLONG</a> FileSize = 0;</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        <span class="comment">// Open the local file</span></div>
<div class="line"><span class="lineno">  187</span>        ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">pStream</a> = <a class="code hl_function" href="FileStream_8cpp.html#a702003c1930c608961b812259bd9dc22">FileStream_OpenFile</a>(szListFile, <a class="code hl_define" href="StormLib_8h.html#abdbbf06488f24699775afe6aadaeafc3">STREAM_FLAG_READ_ONLY</a>);</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span>(ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">pStream</a> != NULL)</div>
<div class="line"><span class="lineno">  189</span>        {</div>
<div class="line"><span class="lineno">  190</span>            <span class="comment">// Verify the file size</span></div>
<div class="line"><span class="lineno">  191</span>            <a class="code hl_function" href="FileStream_8cpp.html#af505319882f0f4aaf396b6d061a2275b">FileStream_GetSize</a>(ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">pStream</a>, &amp;FileSize);</div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordflow">if</span>(0 &lt; FileSize &amp;&amp; FileSize &lt; dwMaxSize)</div>
<div class="line"><span class="lineno">  193</span>            {</div>
<div class="line"><span class="lineno">  194</span>                pCache = <a class="code hl_function" href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a>(<a class="code hl_function" href="SFileListFile_8cpp.html#a9e924aff77033ed1f2a32022a09a7b0f">LoadListFile_Stream</a>, &amp;ListHandle, szWildCard, (<a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>)FileSize, dwMaxSize, dwFlags);</div>
<div class="line"><span class="lineno">  195</span>            }</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>            <span class="comment">// Close the stream</span></div>
<div class="line"><span class="lineno">  198</span>            <a class="code hl_function" href="FileStream_8cpp.html#ae8b75c4797726e9c5ee0b4b03bf31442">FileStream_Close</a>(ListHandle.<a class="code hl_variable" href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">pStream</a>);</div>
<div class="line"><span class="lineno">  199</span>        }</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>        <span class="comment">// Return the loaded cache</span></div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">return</span> pCache;</div>
<div class="line"><span class="lineno">  203</span>    }</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">// This combination should never happen</span></div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(<a class="code hl_define" href="StormPort_8h.html#a176960f93d11db6f58d10a6957a80f38">ERROR_INVALID_PARAMETER</a>);</div>
<div class="line"><span class="lineno">  207</span>    assert(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  209</span>}</div>
<div class="ttc" id="aFileStream_8cpp_html_a65dd8d3e416ffbd6ac5f468c6bdccac9"><div class="ttname"><a href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a></div><div class="ttdeci">void SetLastError(DWORD dwErrCode)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l00049">FileStream.cpp:49</a></div></div>
<div class="ttc" id="aFileStream_8cpp_html_a702003c1930c608961b812259bd9dc22"><div class="ttname"><a href="FileStream_8cpp.html#a702003c1930c608961b812259bd9dc22">FileStream_OpenFile</a></div><div class="ttdeci">TFileStream * FileStream_OpenFile(const TCHAR *szFileName, DWORD dwStreamFlags)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l02499">FileStream.cpp:2499</a></div></div>
<div class="ttc" id="aFileStream_8cpp_html_ae8b75c4797726e9c5ee0b4b03bf31442"><div class="ttname"><a href="FileStream_8cpp.html#ae8b75c4797726e9c5ee0b4b03bf31442">FileStream_Close</a></div><div class="ttdeci">void FileStream_Close(TFileStream *pStream)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l02907">FileStream.cpp:2907</a></div></div>
<div class="ttc" id="aFileStream_8cpp_html_af505319882f0f4aaf396b6d061a2275b"><div class="ttname"><a href="FileStream_8cpp.html#af505319882f0f4aaf396b6d061a2275b">FileStream_GetSize</a></div><div class="ttdeci">bool FileStream_GetSize(TFileStream *pStream, ULONGLONG *pFileSize)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l02795">FileStream.cpp:2795</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_a0ca63d621208bf3a7919ed605ee6cdd3"><div class="ttname"><a href="SFileListFile_8cpp.html#a0ca63d621208bf3a7919ed605ee6cdd3">MAX_LISTFILE_SIZE</a></div><div class="ttdeci">#define MAX_LISTFILE_SIZE</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00020">SFileListFile.cpp:20</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_a19d96cb819377f37c1632337009d6f52"><div class="ttname"><a href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a></div><div class="ttdeci">static TListFileCache * CreateListFileCache(LOAD_LISTFILE PfnLoadFile, TListFileHandle *pHandle, const char *szWildCard, DWORD dwFileSize, DWORD dwMaxSize, DWORD dwFlags)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00084">SFileListFile.cpp:84</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_a785a7726363d009ad01d100b4d7cfd56"><div class="ttname"><a href="SFileListFile_8cpp.html#a785a7726363d009ad01d100b4d7cfd56">LoadListFile_MPQ</a></div><div class="ttdeci">static bool LoadListFile_MPQ(TListFileHandle *pHandle, void *pvBuffer, DWORD cbBuffer, LPDWORD pdwBytesRead)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00071">SFileListFile.cpp:71</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_a9e924aff77033ed1f2a32022a09a7b0f"><div class="ttname"><a href="SFileListFile_8cpp.html#a9e924aff77033ed1f2a32022a09a7b0f">LoadListFile_Stream</a></div><div class="ttdeci">static bool LoadListFile_Stream(TListFileHandle *pHandle, void *pvBuffer, DWORD cbBuffer, LPDWORD pdwBytesRead)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00060">SFileListFile.cpp:60</a></div></div>
<div class="ttc" id="aSFileOpenFileEx_8cpp_html_a0049c66b1dbb981f5b69afe6bbe60313"><div class="ttname"><a href="SFileOpenFileEx_8cpp.html#a0049c66b1dbb981f5b69afe6bbe60313">SFileOpenFileEx</a></div><div class="ttdeci">bool WINAPI SFileOpenFileEx(HANDLE hMpq, const char *szFileName, DWORD dwSearchScope, HANDLE *PtrFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileOpenFileEx_8cpp_source.html#l00232">SFileOpenFileEx.cpp:232</a></div></div>
<div class="ttc" id="aSFileOpenFileEx_8cpp_html_a49a09a38e6dc3b1afd95163a1c9052c6"><div class="ttname"><a href="SFileOpenFileEx_8cpp.html#a49a09a38e6dc3b1afd95163a1c9052c6">SFileCloseFile</a></div><div class="ttdeci">bool WINAPI SFileCloseFile(HANDLE hFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileOpenFileEx_8cpp_source.html#l00405">SFileOpenFileEx.cpp:405</a></div></div>
<div class="ttc" id="aSFileReadFile_8cpp_html_a1d30c5a49fb9c1c1669884646282e4d3"><div class="ttname"><a href="SFileReadFile_8cpp.html#a1d30c5a49fb9c1c1669884646282e4d3">SFileGetFileSize</a></div><div class="ttdeci">DWORD WINAPI SFileGetFileSize(HANDLE hFile, LPDWORD pdwFileSizeHigh)</div><div class="ttdef"><b>Definition</b> <a href="SFileReadFile_8cpp_source.html#l00769">SFileReadFile.cpp:769</a></div></div>
<div class="ttc" id="aStormLib_8h_html_abdbbf06488f24699775afe6aadaeafc3"><div class="ttname"><a href="StormLib_8h.html#abdbbf06488f24699775afe6aadaeafc3">STREAM_FLAG_READ_ONLY</a></div><div class="ttdeci">#define STREAM_FLAG_READ_ONLY</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00321">StormLib.h:321</a></div></div>
<div class="ttc" id="aStormLib_8h_html_ac797c1c425d999b5bc992e2e39b4169e"><div class="ttname"><a href="StormLib_8h.html#ac797c1c425d999b5bc992e2e39b4169e">LISTFILE_NAME</a></div><div class="ttdeci">#define LISTFILE_NAME</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00290">StormLib.h:290</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a176960f93d11db6f58d10a6957a80f38"><div class="ttname"><a href="StormPort_8h.html#a176960f93d11db6f58d10a6957a80f38">ERROR_INVALID_PARAMETER</a></div><div class="ttdeci">#define ERROR_INVALID_PARAMETER</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00407">StormPort.h:407</a></div></div>
<div class="ttc" id="aStormPort_8h_html_abb9abb9ce956f1a9e5a4081ac40e5649"><div class="ttname"><a href="StormPort_8h.html#abb9abb9ce956f1a9e5a4081ac40e5649">ULONGLONG</a></div><div class="ttdeci">unsigned long long ULONGLONG</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00341">StormPort.h:341</a></div></div>
<div class="ttc" id="astructTListFileCache_html"><div class="ttname"><a href="structTListFileCache.html">TListFileCache</a></div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00028">SFileListFile.cpp:29</a></div></div>
<div class="ttc" id="aunionTListFileHandle_html"><div class="ttname"><a href="unionTListFileHandle.html">TListFileHandle</a></div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00022">SFileListFile.cpp:23</a></div></div>
<div class="ttc" id="aunionTListFileHandle_html_a087392bfa9a1ae15397d56097df147bf"><div class="ttname"><a href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">TListFileHandle::pStream</a></div><div class="ttdeci">TFileStream * pStream</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00024">SFileListFile.cpp:24</a></div></div>
<div class="ttc" id="aunionTListFileHandle_html_a3db406ed0aabe7b8f732649a78e8d065"><div class="ttname"><a href="unionTListFileHandle.html#a3db406ed0aabe7b8f732649a78e8d065">TListFileHandle::hFile</a></div><div class="ttdeci">HANDLE hFile</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00025">SFileListFile.cpp:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a6195145d2c2de3dd2f73fd4d21b7c351_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a19d96cb819377f37c1632337009d6f52" name="a19d96cb819377f37c1632337009d6f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19d96cb819377f37c1632337009d6f52">&#9670;&#160;</a></span>CreateListFileCache() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structTListFileCache.html">TListFileCache</a> * CreateListFileCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SFileListFile_8cpp.html#ad3e471dd32b926b82b31c1a89abe4801">LOAD_LISTFILE</a>&#160;</td>
          <td class="paramname"><em>PfnLoadFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szWildCard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwFileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwMaxSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00084">84</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> * pCache = NULL;</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordtype">size_t</span> cchWildCardAligned = 0;</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordtype">size_t</span> cchWildCard = 0;</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwBytesRead = 0;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="comment">// Get the amount of bytes that need to be allocated</span></div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span>(dwFileSize == 0 || dwFileSize &gt; dwMaxSize)</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="comment">// Append buffer for name mask, if any</span></div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span>(szWildCard != NULL)</div>
<div class="line"><span class="lineno">  103</span>    {</div>
<div class="line"><span class="lineno">  104</span>        cchWildCard = strlen(szWildCard) + 1;</div>
<div class="line"><span class="lineno">  105</span>        cchWildCardAligned = (cchWildCard + 3) &amp; 0xFFFFFFFC;</div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="comment">// Allocate cache for one file block</span></div>
<div class="line"><span class="lineno">  109</span>    pCache = (<a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> *)<a class="code hl_define" href="StormCommon_8h.html#a6fe0c42173ef1a4b9f0e837b0c631660">STORM_ALLOC</a>(<a class="code hl_typedef" href="StormPort_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a>) + cchWildCardAligned + dwFileSize + 1);</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">if</span>(pCache != NULL)</div>
<div class="line"><span class="lineno">  111</span>    {</div>
<div class="line"><span class="lineno">  112</span>        <span class="comment">// Clear the entire structure</span></div>
<div class="line"><span class="lineno">  113</span>        memset(pCache, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a>) + cchWildCard);</div>
<div class="line"><span class="lineno">  114</span>        pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#aa1991e09f43385f67b65fea210948b60">dwFlags</a> = dwFlags;</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>        <span class="comment">// Shall we copy the mask?</span></div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">if</span>(cchWildCard != 0)</div>
<div class="line"><span class="lineno">  118</span>        {</div>
<div class="line"><span class="lineno">  119</span>            pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a46020bdcd8938b2892637833493cfe3f">szWildCard</a> = (<span class="keywordtype">char</span> *)(pCache + 1);</div>
<div class="line"><span class="lineno">  120</span>            memcpy(pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a46020bdcd8938b2892637833493cfe3f">szWildCard</a>, szWildCard, cchWildCard);</div>
<div class="line"><span class="lineno">  121</span>        }</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>        <span class="comment">// Fill-in the rest of the cache pointers</span></div>
<div class="line"><span class="lineno">  124</span>        pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a0cae67fd04a67f8e549dbf42efbf49c7">pBegin</a> = (<a class="code hl_typedef" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a>)(pCache + 1) + cchWildCardAligned;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">// Load the entire listfile to the cache</span></div>
<div class="line"><span class="lineno">  127</span>        PfnLoadFile(pHandle, pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a0cae67fd04a67f8e549dbf42efbf49c7">pBegin</a>, dwFileSize, &amp;dwBytesRead);</div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span>(dwBytesRead != 0)</div>
<div class="line"><span class="lineno">  129</span>        {</div>
<div class="line"><span class="lineno">  130</span>            <span class="comment">// Allocate pointers</span></div>
<div class="line"><span class="lineno">  131</span>            pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a> = pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a0cae67fd04a67f8e549dbf42efbf49c7">pBegin</a>;</div>
<div class="line"><span class="lineno">  132</span>            pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a9d3df665c6095af85aa9bcf40f80d665">pEnd</a> = pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a0cae67fd04a67f8e549dbf42efbf49c7">pBegin</a> + dwBytesRead;</div>
<div class="line"><span class="lineno">  133</span>        }</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  135</span>        {</div>
<div class="line"><span class="lineno">  136</span>            <a class="code hl_function" href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a>(pCache);</div>
<div class="line"><span class="lineno">  137</span>            pCache = NULL;</div>
<div class="line"><span class="lineno">  138</span>        }</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <span class="comment">// Return the cache</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">return</span> pCache;</div>
<div class="line"><span class="lineno">  143</span>}</div>
<div class="ttc" id="aSFileListFile_8cpp_html_abe247b168feddf4764a34c901353b65e"><div class="ttname"><a href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a></div><div class="ttdeci">static bool FreeListFileCache(TListFileCache *pCache)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00076">SFileListFile.cpp:76</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a4ae1dab0fb4b072a66584546209e7d58"><div class="ttname"><a href="StormPort_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></div><div class="ttdeci">unsigned char BYTE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00333">StormPort.h:333</a></div></div>
<div class="ttc" id="astructTListFileCache_html_a0cae67fd04a67f8e549dbf42efbf49c7"><div class="ttname"><a href="structTListFileCache.html#a0cae67fd04a67f8e549dbf42efbf49c7">TListFileCache::pBegin</a></div><div class="ttdeci">LPBYTE pBegin</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00031">SFileListFile.cpp:31</a></div></div>
<div class="ttc" id="astructTListFileCache_html_a46020bdcd8938b2892637833493cfe3f"><div class="ttname"><a href="structTListFileCache.html#a46020bdcd8938b2892637833493cfe3f">TListFileCache::szWildCard</a></div><div class="ttdeci">char * szWildCard</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00030">SFileListFile.cpp:30</a></div></div>
<div class="ttc" id="astructTListFileCache_html_a920cd5d125c818ec4b8cd2b91866c7b1"><div class="ttname"><a href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">TListFileCache::pPos</a></div><div class="ttdeci">LPBYTE pPos</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00032">SFileListFile.cpp:32</a></div></div>
<div class="ttc" id="astructTListFileCache_html_a9d3df665c6095af85aa9bcf40f80d665"><div class="ttname"><a href="structTListFileCache.html#a9d3df665c6095af85aa9bcf40f80d665">TListFileCache::pEnd</a></div><div class="ttdeci">LPBYTE pEnd</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00033">SFileListFile.cpp:33</a></div></div>
<div class="ttc" id="astructTListFileCache_html_aa1991e09f43385f67b65fea210948b60"><div class="ttname"><a href="structTListFileCache.html#aa1991e09f43385f67b65fea210948b60">TListFileCache::dwFlags</a></div><div class="ttdeci">DWORD dwFlags</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00034">SFileListFile.cpp:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a19d96cb819377f37c1632337009d6f52_cgraph.svg" width="346" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a19d96cb819377f37c1632337009d6f52_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a29315b5c89f4ff1691be43e6cc5b8eb0" name="a29315b5c89f4ff1691be43e6cc5b8eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29315b5c89f4ff1691be43e6cc5b8eb0">&#9670;&#160;</a></span>DoListFileSearch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> DoListFileSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTListFileCache.html">TListFileCache</a> *&#160;</td>
          <td class="paramname"><em>pCache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00605">605</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  606</span>{</div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// Check for the valid search handle</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="keywordflow">if</span>(pCache != NULL)</div>
<div class="line"><span class="lineno">  609</span>    {</div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordtype">char</span> * szFileName;</div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordtype">size_t</span> nLength = 0;</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <span class="comment">// Get the next line</span></div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">while</span>((szFileName = <a class="code hl_function" href="SFileListFile_8cpp.html#aaa3440d25147e9668c5ee97d079ce859">ReadListFileLine</a>(pCache, &amp;nLength)) != NULL)</div>
<div class="line"><span class="lineno">  615</span>        {</div>
<div class="line"><span class="lineno">  616</span>            <span class="comment">// Check search mask</span></div>
<div class="line"><span class="lineno">  617</span>            <span class="keywordflow">if</span>(nLength != 0 &amp;&amp; <a class="code hl_function" href="SFileListFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a>(szFileName, pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a46020bdcd8938b2892637833493cfe3f">szWildCard</a>))</div>
<div class="line"><span class="lineno">  618</span>            {</div>
<div class="line"><span class="lineno">  619</span>                <span class="keywordflow">if</span>(nLength &gt;= <span class="keyword">sizeof</span>(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>))</div>
<div class="line"><span class="lineno">  620</span>                    nLength = <span class="keyword">sizeof</span>(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>) - 1;</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>                memcpy(lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>, szFileName, nLength);</div>
<div class="line"><span class="lineno">  623</span>                lpFindFileData-&gt;<a class="code hl_variable" href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">cFileName</a>[nLength] = 0;</div>
<div class="line"><span class="lineno">  624</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  625</span>            }</div>
<div class="line"><span class="lineno">  626</span>        }</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="comment">// No more files</span></div>
<div class="line"><span class="lineno">  630</span>    memset(lpFindFileData, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct__SFILE__FIND__DATA.html">SFILE_FIND_DATA</a>));</div>
<div class="line"><span class="lineno">  631</span>    <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(<a class="code hl_define" href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a>);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  633</span>}</div>
<div class="ttc" id="aSFileListFile_8cpp_html_a73a025a0f97982f04996b923c97ff795"><div class="ttname"><a href="SFileListFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a></div><div class="ttdeci">bool SFileCheckWildCard(const char *szString, const char *szWildCard)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00042">SFileFindFile.cpp:42</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_aaa3440d25147e9668c5ee97d079ce859"><div class="ttname"><a href="SFileListFile_8cpp.html#aaa3440d25147e9668c5ee97d079ce859">ReadListFileLine</a></div><div class="ttdeci">static char * ReadListFileLine(TListFileCache *pCache, size_t *PtrLength)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00275">SFileListFile.cpp:275</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a9f424565beb1161bf33b31748c6c16ba"><div class="ttname"><a href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a></div><div class="ttdeci">#define ERROR_NO_MORE_FILES</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00413">StormPort.h:413</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html">_SFILE_FIND_DATA</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00903">StormLib.h:904</a></div></div>
<div class="ttc" id="astruct__SFILE__FIND__DATA_html_a9ae6998520897bcbbb9fd9971bce2d1e"><div class="ttname"><a href="struct__SFILE__FIND__DATA.html#a9ae6998520897bcbbb9fd9971bce2d1e">_SFILE_FIND_DATA::cFileName</a></div><div class="ttdeci">char cFileName[MAX_PATH]</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00905">StormLib.h:905</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a29315b5c89f4ff1691be43e6cc5b8eb0_cgraph.svg" width="342" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a29315b5c89f4ff1691be43e6cc5b8eb0_icgraph.svg" width="347" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abe247b168feddf4764a34c901353b65e" name="abe247b168feddf4764a34c901353b65e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe247b168feddf4764a34c901353b65e">&#9670;&#160;</a></span>FreeListFileCache()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> FreeListFileCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTListFileCache.html">TListFileCache</a> *&#160;</td>
          <td class="paramname"><em>pCache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00076">76</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>{</div>
<div class="line"><span class="lineno">   78</span>    <span class="comment">// Valid parameter check</span></div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span>(pCache != NULL)</div>
<div class="line"><span class="lineno">   80</span>        <a class="code hl_define" href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a>(pCache);</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   82</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_abe247b168feddf4764a34c901353b65e_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a785a7726363d009ad01d100b4d7cfd56" name="a785a7726363d009ad01d100b4d7cfd56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785a7726363d009ad01d100b4d7cfd56">&#9670;&#160;</a></span>LoadListFile_MPQ()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> LoadListFile_MPQ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>cbBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a>&#160;</td>
          <td class="paramname"><em>pdwBytesRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00071">71</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span>{</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="SFileReadFile_8cpp.html#a3c81a68cbecef70ab57c9d3145ef8b7d">SFileReadFile</a>(pHandle-&gt;<a class="code hl_variable" href="unionTListFileHandle.html#a3db406ed0aabe7b8f732649a78e8d065">hFile</a>, pvBuffer, cbBuffer, pdwBytesRead, NULL);</div>
<div class="line"><span class="lineno">   74</span>}</div>
<div class="ttc" id="aSFileReadFile_8cpp_html_a3c81a68cbecef70ab57c9d3145ef8b7d"><div class="ttname"><a href="SFileReadFile_8cpp.html#a3c81a68cbecef70ab57c9d3145ef8b7d">SFileReadFile</a></div><div class="ttdeci">bool WINAPI SFileReadFile(HANDLE hFile, void *pvBuffer, DWORD dwToRead, LPDWORD pdwRead, LPOVERLAPPED lpOverlapped)</div><div class="ttdef"><b>Definition</b> <a href="SFileReadFile_8cpp_source.html#l00678">SFileReadFile.cpp:678</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a785a7726363d009ad01d100b4d7cfd56_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a785a7726363d009ad01d100b4d7cfd56_icgraph.svg" width="346" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9e924aff77033ed1f2a32022a09a7b0f" name="a9e924aff77033ed1f2a32022a09a7b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e924aff77033ed1f2a32022a09a7b0f">&#9670;&#160;</a></span>LoadListFile_Stream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> LoadListFile_Stream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="unionTListFileHandle.html">TListFileHandle</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>cbBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a143be739596851314f3c386bd6f752f9">LPDWORD</a>&#160;</td>
          <td class="paramname"><em>pdwBytesRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00060">60</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>{</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_typedef" href="StormPort_8h.html#abb9abb9ce956f1a9e5a4081ac40e5649">ULONGLONG</a> ByteOffset = 0;</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">bool</span> bResult;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    bResult = <a class="code hl_function" href="FileStream_8cpp.html#a593f3b1416f7497c28fa5552cd1b3003">FileStream_Read</a>(pHandle-&gt;<a class="code hl_variable" href="unionTListFileHandle.html#a087392bfa9a1ae15397d56097df147bf">pStream</a>, &amp;ByteOffset, pvBuffer, cbBuffer);</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">if</span>(bResult)</div>
<div class="line"><span class="lineno">   67</span>        *pdwBytesRead = cbBuffer;</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">return</span> bResult;</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="aFileStream_8cpp_html_a593f3b1416f7497c28fa5552cd1b3003"><div class="ttname"><a href="FileStream_8cpp.html#a593f3b1416f7497c28fa5552cd1b3003">FileStream_Read</a></div><div class="ttdeci">bool FileStream_Read(TFileStream *pStream, ULONGLONG *pByteOffset, void *pvBuffer, DWORD dwBytesToRead)</div><div class="ttdef"><b>Definition</b> <a href="FileStream_8cpp_source.html#l02759">FileStream.cpp:2759</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a9e924aff77033ed1f2a32022a09a7b0f_cgraph.svg" width="344" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a9e924aff77033ed1f2a32022a09a7b0f_icgraph.svg" width="363" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aaa3440d25147e9668c5ee97d079ce859" name="aaa3440d25147e9668c5ee97d079ce859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa3440d25147e9668c5ee97d079ce859">&#9670;&#160;</a></span>ReadListFileLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * ReadListFileLine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTListFileCache.html">TListFileCache</a> *&#160;</td>
          <td class="paramname"><em>pCache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>PtrLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00275">275</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>{</div>
<div class="line"><span class="lineno">  277</span>    <a class="code hl_typedef" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a> pbLineBegin;</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_typedef" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a> pbLineEnd;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>    <span class="comment">// Skip newlines. Keep spaces and tabs, as they can be a legal part of the file name</span></div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">while</span>(pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a> &lt; pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a9d3df665c6095af85aa9bcf40f80d665">pEnd</a> &amp;&amp; (pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>[0] == 0x0A || pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>[0] == 0x0D))</div>
<div class="line"><span class="lineno">  282</span>        pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>++;</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">// Set the line begin and end</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span>(pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a> &gt;= pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a9d3df665c6095af85aa9bcf40f80d665">pEnd</a>)</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  287</span>    pbLineBegin = pbLineEnd = pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>;</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">// Find the end of the line</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">while</span>(pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a> &lt; pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a9d3df665c6095af85aa9bcf40f80d665">pEnd</a> &amp;&amp; pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>[0] != 0x0A &amp;&amp; pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>[0] != 0x0D)</div>
<div class="line"><span class="lineno">  291</span>        pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>++;</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">// Remember the end of the line</span></div>
<div class="line"><span class="lineno">  294</span>    pbLineEnd = pCache-&gt;<a class="code hl_variable" href="structTListFileCache.html#a920cd5d125c818ec4b8cd2b91866c7b1">pPos</a>++;</div>
<div class="line"><span class="lineno">  295</span>    pbLineEnd[0] = 0;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// Give the line to the caller</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span>(PtrLength != NULL)</div>
<div class="line"><span class="lineno">  299</span>        PtrLength[0] = (size_t)(pbLineEnd - pbLineBegin);</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)pbLineBegin;</div>
<div class="line"><span class="lineno">  301</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_aaa3440d25147e9668c5ee97d079ce859_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa5f0f70ba9f777b1ba98546d16484070" name="aa5f0f70ba9f777b1ba98546d16484070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5f0f70ba9f777b1ba98546d16484070">&#9670;&#160;</a></span>SFileAddArbitraryListFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> SFileAddArbitraryListFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *&#160;</td>
          <td class="paramname"><em>szListFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwMaxSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00531">531</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  536</span>{</div>
<div class="line"><span class="lineno">  537</span>    <a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> * pCache = NULL;</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">// Create the listfile cache for that file</span></div>
<div class="line"><span class="lineno">  540</span>    pCache = <a class="code hl_function" href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a>(hMpq, szListFile, NULL, dwMaxSize, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">dwFlags</a>);</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">if</span>(pCache != NULL)</div>
<div class="line"><span class="lineno">  542</span>    {</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordtype">char</span> * szFileName;</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordtype">size_t</span> nLength = 0;</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        <span class="comment">// Get the next line</span></div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">while</span>((szFileName = <a class="code hl_function" href="SFileListFile_8cpp.html#aaa3440d25147e9668c5ee97d079ce859">ReadListFileLine</a>(pCache, &amp;nLength)) != NULL)</div>
<div class="line"><span class="lineno">  548</span>        {</div>
<div class="line"><span class="lineno">  549</span>            <span class="comment">// Add the line to the MPQ</span></div>
<div class="line"><span class="lineno">  550</span>            <span class="keywordflow">if</span>(nLength != 0)</div>
<div class="line"><span class="lineno">  551</span>                <a class="code hl_function" href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a>(ha, szFileName);</div>
<div class="line"><span class="lineno">  552</span>        }</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>        <span class="comment">// Delete the cache</span></div>
<div class="line"><span class="lineno">  555</span>        <a class="code hl_function" href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a>(pCache);</div>
<div class="line"><span class="lineno">  556</span>    }</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">return</span> (pCache != NULL) ? <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a> : <a class="code hl_define" href="StormPort_8h.html#a16efe2101191997f3ac8f2e7bb7894b8">ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><span class="lineno">  559</span>}</div>
<div class="ttc" id="aSFileListFile_8cpp_html_a28970c3b2769a1db546e497b138e2034"><div class="ttname"><a href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a></div><div class="ttdeci">static DWORD SListFileCreateNodeForAllLocales(TMPQArchive *ha, const char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00409">SFileListFile.cpp:409</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a16efe2101191997f3ac8f2e7bb7894b8"><div class="ttname"><a href="StormPort_8h.html#a16efe2101191997f3ac8f2e7bb7894b8">ERROR_FILE_CORRUPT</a></div><div class="ttdeci">#define ERROR_FILE_CORRUPT</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00416">StormPort.h:416</a></div></div>
<div class="ttc" id="aStormPort_8h_html_aea0ae801b7d25c979655a7eb20d034af"><div class="ttname"><a href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a></div><div class="ttdeci">#define ERROR_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00401">StormPort.h:401</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a4f1bf356f8e6dd8d3ec1faeec821aa6c"><div class="ttname"><a href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">_TMPQArchive::dwFlags</a></div><div class="ttdeci">DWORD dwFlags</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00850">StormLib.h:850</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_aa5f0f70ba9f777b1ba98546d16484070_cgraph.svg" width="100%" height="538"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_aa5f0f70ba9f777b1ba98546d16484070_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ab8880b420fb6890e6d2ae8cc56fdc7e7" name="ab8880b420fb6890e6d2ae8cc56fdc7e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8880b420fb6890e6d2ae8cc56fdc7e7">&#9670;&#160;</a></span>SFileAddInternalListFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> SFileAddInternalListFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00561">561</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  564</span>{</div>
<div class="line"><span class="lineno">  565</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pFirstHash;</div>
<div class="line"><span class="lineno">  566</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pHash;</div>
<div class="line"><span class="lineno">  567</span>    <a class="code hl_typedef" href="StormPort_8h.html#ab1742dccc5f422e3ca4eee21d56e0086">LCID</a> lcSaveLocale = <a class="code hl_variable" href="SBaseCommon_8cpp.html#a45e71286a36272815b1bf6d4f09aab9a">g_lcFileLocale</a>;</div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwMaxSize = <a class="code hl_define" href="SFileListFile_8cpp.html#a0ca63d621208bf3a7919ed605ee6cdd3">MAX_LISTFILE_SIZE</a>;</div>
<div class="line"><span class="lineno">  569</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode = <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <span class="comment">// If there is hash table, we need to support multiple listfiles</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="comment">// with different locales (BrooDat.mpq)</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> != NULL)</div>
<div class="line"><span class="lineno">  574</span>    {</div>
<div class="line"><span class="lineno">  575</span>        <span class="comment">// If the archive is a malformed map, ignore too large listfiles</span></div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">dwFlags</a> &amp; <a class="code hl_define" href="StormLib_8h.html#a4e78695275e602042f25c946a7a8fdb5">MPQ_FLAG_MALFORMED</a>)</div>
<div class="line"><span class="lineno">  577</span>            dwMaxSize = 0x40000;</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>        pFirstHash = pHash = <a class="code hl_function" href="SBaseCommon_8cpp.html#a30262df6aa40d7d4f4d37814a8de734c">GetFirstHashEntry</a>(ha, <a class="code hl_define" href="StormLib_8h.html#ac797c1c425d999b5bc992e2e39b4169e">LISTFILE_NAME</a>);</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">while</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a> &amp;&amp; pHash != NULL)</div>
<div class="line"><span class="lineno">  581</span>        {</div>
<div class="line"><span class="lineno">  582</span>            <span class="comment">// Set the prefered locale to that from list file</span></div>
<div class="line"><span class="lineno">  583</span>            <a class="code hl_function" href="SFileOpenArchive_8cpp.html#ab0683c4b0bbf74b521c9f382b51b6e23">SFileSetLocale</a>(<a class="code hl_define" href="StormLib_8h.html#aac5d37546e56cecc39acc9223a466f74">SFILE_MAKE_LCID</a>(pHash-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#a739c78235438c89d2cd6e6c0d44402ce">Locale</a>, pHash-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#a8712ff7211834dfc7314c5d682866d88">Platform</a>));</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>            <span class="comment">// Add that listfile</span></div>
<div class="line"><span class="lineno">  586</span>            dwErrCode = <a class="code hl_function" href="SFileListFile_8cpp.html#aa5f0f70ba9f777b1ba98546d16484070">SFileAddArbitraryListFile</a>(ha, hMpq, NULL, dwMaxSize);</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>            <span class="comment">// Move to the next hash</span></div>
<div class="line"><span class="lineno">  589</span>            pHash = <a class="code hl_function" href="SBaseCommon_8cpp.html#aa9b3131395d4877f9d3793f2c7671886">GetNextHashEntry</a>(ha, pFirstHash, pHash);</div>
<div class="line"><span class="lineno">  590</span>        }</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>        <span class="comment">// Restore the original locale</span></div>
<div class="line"><span class="lineno">  593</span>        <a class="code hl_function" href="SFileOpenArchive_8cpp.html#ab0683c4b0bbf74b521c9f382b51b6e23">SFileSetLocale</a>(lcSaveLocale);</div>
<div class="line"><span class="lineno">  594</span>    }</div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  596</span>    {</div>
<div class="line"><span class="lineno">  597</span>        <span class="comment">// Add the single listfile</span></div>
<div class="line"><span class="lineno">  598</span>        dwErrCode = <a class="code hl_function" href="SFileListFile_8cpp.html#aa5f0f70ba9f777b1ba98546d16484070">SFileAddArbitraryListFile</a>(ha, hMpq, NULL, dwMaxSize);</div>
<div class="line"><span class="lineno">  599</span>    }</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">// Return the result of the operation</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordflow">return</span> dwErrCode;</div>
<div class="line"><span class="lineno">  603</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a30262df6aa40d7d4f4d37814a8de734c"><div class="ttname"><a href="SBaseCommon_8cpp.html#a30262df6aa40d7d4f4d37814a8de734c">GetFirstHashEntry</a></div><div class="ttdeci">TMPQHash * GetFirstHashEntry(TMPQArchive *ha, const char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00787">SBaseCommon.cpp:787</a></div></div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a45e71286a36272815b1bf6d4f09aab9a"><div class="ttname"><a href="SBaseCommon_8cpp.html#a45e71286a36272815b1bf6d4f09aab9a">g_lcFileLocale</a></div><div class="ttdeci">LCID g_lcFileLocale</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00026">SBaseCommon.cpp:26</a></div></div>
<div class="ttc" id="aSBaseCommon_8cpp_html_aa9b3131395d4877f9d3793f2c7671886"><div class="ttname"><a href="SBaseCommon_8cpp.html#aa9b3131395d4877f9d3793f2c7671886">GetNextHashEntry</a></div><div class="ttdeci">TMPQHash * GetNextHashEntry(TMPQArchive *ha, TMPQHash *pFirstHash, TMPQHash *pHash)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00819">SBaseCommon.cpp:819</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_aa5f0f70ba9f777b1ba98546d16484070"><div class="ttname"><a href="SFileListFile_8cpp.html#aa5f0f70ba9f777b1ba98546d16484070">SFileAddArbitraryListFile</a></div><div class="ttdeci">static DWORD SFileAddArbitraryListFile(TMPQArchive *ha, HANDLE hMpq, const TCHAR *szListFile, DWORD dwMaxSize)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00531">SFileListFile.cpp:531</a></div></div>
<div class="ttc" id="aSFileOpenArchive_8cpp_html_ab0683c4b0bbf74b521c9f382b51b6e23"><div class="ttname"><a href="SFileOpenArchive_8cpp.html#ab0683c4b0bbf74b521c9f382b51b6e23">SFileSetLocale</a></div><div class="ttdeci">LCID WINAPI SFileSetLocale(LCID lcFileLocale)</div><div class="ttdef"><b>Definition</b> <a href="SFileOpenArchive_8cpp_source.html#l00212">SFileOpenArchive.cpp:212</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a4e78695275e602042f25c946a7a8fdb5"><div class="ttname"><a href="StormLib_8h.html#a4e78695275e602042f25c946a7a8fdb5">MPQ_FLAG_MALFORMED</a></div><div class="ttdeci">#define MPQ_FLAG_MALFORMED</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00189">StormLib.h:189</a></div></div>
<div class="ttc" id="aStormLib_8h_html_aac5d37546e56cecc39acc9223a466f74"><div class="ttname"><a href="StormLib_8h.html#aac5d37546e56cecc39acc9223a466f74">SFILE_MAKE_LCID</a></div><div class="ttdeci">#define SFILE_MAKE_LCID(locale, platform)</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00999">StormLib.h:999</a></div></div>
<div class="ttc" id="aStormPort_8h_html_ab1742dccc5f422e3ca4eee21d56e0086"><div class="ttname"><a href="StormPort_8h.html#ab1742dccc5f422e3ca4eee21d56e0086">LCID</a></div><div class="ttdeci">unsigned int LCID</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00345">StormPort.h:345</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_ad3ec9127fcae2cd440073adbc3f21fba"><div class="ttname"><a href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">_TMPQArchive::pHashTable</a></div><div class="ttdeci">TMPQHash * pHashTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00830">StormLib.h:830</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html"><div class="ttname"><a href="struct__TMPQHash.html">_TMPQHash</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00619">StormLib.h:620</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_a739c78235438c89d2cd6e6c0d44402ce"><div class="ttname"><a href="struct__TMPQHash.html#a739c78235438c89d2cd6e6c0d44402ce">_TMPQHash::Locale</a></div><div class="ttdeci">USHORT Locale</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00631">StormLib.h:631</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_a8712ff7211834dfc7314c5d682866d88"><div class="ttname"><a href="struct__TMPQHash.html#a8712ff7211834dfc7314c5d682866d88">_TMPQHash::Platform</a></div><div class="ttdeci">BYTE Platform</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00635">StormLib.h:635</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ab8880b420fb6890e6d2ae8cc56fdc7e7_cgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ab8880b420fb6890e6d2ae8cc56fdc7e7_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ab699405208db728f480c491831904e36" name="ab699405208db728f480c491831904e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab699405208db728f480c491831904e36">&#9670;&#160;</a></span>SFileAddListFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SFileAddListFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *&#160;</td>
          <td class="paramname"><em>szListFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00639">639</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  640</span>{</div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_struct" href="struct__TMPQArchive.html">TMPQArchive</a> * ha = (<a class="code hl_struct" href="struct__TMPQArchive.html">TMPQArchive</a> *)hMpq;</div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode = <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">// Add the listfile for each MPQ in the patch chain</span></div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">while</span>(ha != NULL)</div>
<div class="line"><span class="lineno">  646</span>    {</div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">if</span>(szListFile != NULL)</div>
<div class="line"><span class="lineno">  648</span>            dwErrCode = <a class="code hl_function" href="SFileListFile_8cpp.html#aa5f0f70ba9f777b1ba98546d16484070">SFileAddArbitraryListFile</a>(ha, NULL, szListFile, <a class="code hl_define" href="SFileListFile_8cpp.html#a0ca63d621208bf3a7919ed605ee6cdd3">MAX_LISTFILE_SIZE</a>);</div>
<div class="line"><span class="lineno">  649</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  650</span>            dwErrCode = <a class="code hl_function" href="SFileListFile_8cpp.html#ab8880b420fb6890e6d2ae8cc56fdc7e7">SFileAddInternalListFile</a>(ha, hMpq);</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <span class="comment">// Also, add three special files to the listfile:</span></div>
<div class="line"><span class="lineno">  653</span>        <span class="comment">// (listfile) itself, (attributes) and (signature)</span></div>
<div class="line"><span class="lineno">  654</span>        <a class="code hl_function" href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a>(ha, <a class="code hl_define" href="StormLib_8h.html#ac797c1c425d999b5bc992e2e39b4169e">LISTFILE_NAME</a>);</div>
<div class="line"><span class="lineno">  655</span>        <a class="code hl_function" href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a>(ha, <a class="code hl_define" href="StormLib_8h.html#ab9ccdfbc136fcd937541b27333e03159">SIGNATURE_NAME</a>);</div>
<div class="line"><span class="lineno">  656</span>        <a class="code hl_function" href="SFileListFile_8cpp.html#a28970c3b2769a1db546e497b138e2034">SListFileCreateNodeForAllLocales</a>(ha, <a class="code hl_define" href="StormLib_8h.html#a5a4e12f2d4a5ad2426f3eb302db71feb">ATTRIBUTES_NAME</a>);</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>        <span class="comment">// Move to the next archive in the chain</span></div>
<div class="line"><span class="lineno">  659</span>        ha = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">haPatch</a>;</div>
<div class="line"><span class="lineno">  660</span>    }</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>    <span class="keywordflow">return</span> dwErrCode;</div>
<div class="line"><span class="lineno">  663</span>}</div>
<div class="ttc" id="aSFileListFile_8cpp_html_ab8880b420fb6890e6d2ae8cc56fdc7e7"><div class="ttname"><a href="SFileListFile_8cpp.html#ab8880b420fb6890e6d2ae8cc56fdc7e7">SFileAddInternalListFile</a></div><div class="ttdeci">static DWORD SFileAddInternalListFile(TMPQArchive *ha, HANDLE hMpq)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00561">SFileListFile.cpp:561</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a5a4e12f2d4a5ad2426f3eb302db71feb"><div class="ttname"><a href="StormLib_8h.html#a5a4e12f2d4a5ad2426f3eb302db71feb">ATTRIBUTES_NAME</a></div><div class="ttdeci">#define ATTRIBUTES_NAME</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00292">StormLib.h:292</a></div></div>
<div class="ttc" id="aStormLib_8h_html_ab9ccdfbc136fcd937541b27333e03159"><div class="ttname"><a href="StormLib_8h.html#ab9ccdfbc136fcd937541b27333e03159">SIGNATURE_NAME</a></div><div class="ttdeci">#define SIGNATURE_NAME</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00291">StormLib.h:291</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html"><div class="ttname"><a href="struct__TMPQArchive.html">_TMPQArchive</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00816">StormLib.h:817</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_aa2646402b5718a74c1908745ea6a46cd"><div class="ttname"><a href="struct__TMPQArchive.html#aa2646402b5718a74c1908745ea6a46cd">_TMPQArchive::haPatch</a></div><div class="ttdeci">struct _TMPQArchive * haPatch</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00824">StormLib.h:824</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ab699405208db728f480c491831904e36_cgraph.svg" width="100%" height="559"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ab699405208db728f480c491831904e36_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a73a025a0f97982f04996b923c97ff795" name="a73a025a0f97982f04996b923c97ff795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a025a0f97982f04996b923c97ff795">&#9670;&#160;</a></span>SFileCheckWildCard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> SFileCheckWildCard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szString</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szWildCard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileFindFile_8cpp_source.html#l00042">42</a> of file <a class="el" href="SFileFindFile_8cpp_source.html">SFileFindFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> * szWildCardPtr;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span>(;;)</div>
<div class="line"><span class="lineno">   47</span>    {</div>
<div class="line"><span class="lineno">   48</span>        <span class="comment">// If there is &#39;?&#39; in the wildcard, we skip one char</span></div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">while</span>(szWildCard[0] == <span class="charliteral">&#39;?&#39;</span>)</div>
<div class="line"><span class="lineno">   50</span>        {</div>
<div class="line"><span class="lineno">   51</span>            <span class="keywordflow">if</span>(szString[0] == 0)</div>
<div class="line"><span class="lineno">   52</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>            szWildCard++;</div>
<div class="line"><span class="lineno">   55</span>            szString++;</div>
<div class="line"><span class="lineno">   56</span>        }</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>        <span class="comment">// Handle &#39;*&#39;</span></div>
<div class="line"><span class="lineno">   59</span>        szWildCardPtr = szWildCard;</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">if</span>(szWildCardPtr[0] != 0)</div>
<div class="line"><span class="lineno">   61</span>        {</div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordflow">if</span>(szWildCardPtr[0] == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><span class="lineno">   63</span>            {</div>
<div class="line"><span class="lineno">   64</span>                <span class="keywordflow">while</span>(szWildCardPtr[0] == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><span class="lineno">   65</span>                    szWildCardPtr++;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>                <span class="keywordflow">if</span>(szWildCardPtr[0] == 0)</div>
<div class="line"><span class="lineno">   68</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szWildCardPtr[0]] == <a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szString[0]])</div>
<div class="line"><span class="lineno">   71</span>                {</div>
<div class="line"><span class="lineno">   72</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a>(szString, szWildCardPtr))</div>
<div class="line"><span class="lineno">   73</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   74</span>                }</div>
<div class="line"><span class="lineno">   75</span>            }</div>
<div class="line"><span class="lineno">   76</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   77</span>            {</div>
<div class="line"><span class="lineno">   78</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szWildCardPtr[0]] != <a class="code hl_variable" href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a>[szString[0]])</div>
<div class="line"><span class="lineno">   79</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>                szWildCard = szWildCardPtr + 1;</div>
<div class="line"><span class="lineno">   82</span>            }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordflow">if</span>(szString[0] == 0)</div>
<div class="line"><span class="lineno">   85</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   86</span>            szString++;</div>
<div class="line"><span class="lineno">   87</span>        }</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   89</span>        {</div>
<div class="line"><span class="lineno">   90</span>            <span class="keywordflow">return</span> (szString[0] == 0) ? <a class="code hl_define" href="StormPort_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a> : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   91</span>        }</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a5f6fa9d0439a797a0a86c5ee70718390"><div class="ttname"><a href="SBaseCommon_8cpp.html#a5f6fa9d0439a797a0a86c5ee70718390">AsciiToUpperTable</a></div><div class="ttdeci">unsigned char AsciiToUpperTable[256]</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00055">SBaseCommon.cpp:55</a></div></div>
<div class="ttc" id="aSFileFindFile_8cpp_html_a73a025a0f97982f04996b923c97ff795"><div class="ttname"><a href="SFileFindFile_8cpp.html#a73a025a0f97982f04996b923c97ff795">SFileCheckWildCard</a></div><div class="ttdeci">bool SFileCheckWildCard(const char *szString, const char *szWildCard)</div><div class="ttdef"><b>Definition</b> <a href="SFileFindFile_8cpp_source.html#l00042">SFileFindFile.cpp:42</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a41f9c5fb8b08eb5dc3edce4dcb37fee7"><div class="ttname"><a href="StormPort_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></div><div class="ttdeci">#define true</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00032">StormPort.h:32</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a73a025a0f97982f04996b923c97ff795_cgraph.svg" width="163" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a73a025a0f97982f04996b923c97ff795_icgraph.svg" width="100%" height="456"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a28970c3b2769a1db546e497b138e2034" name="a28970c3b2769a1db546e497b138e2034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28970c3b2769a1db546e497b138e2034">&#9670;&#160;</a></span>SListFileCreateNodeForAllLocales()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> SListFileCreateNodeForAllLocales </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szFileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00409">409</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  410</span>{</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_struct" href="struct__TFileEntry.html">TFileEntry</a> * pFileEntry;</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pHashEnd;</div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_struct" href="struct__TMPQHash.html">TMPQHash</a> * pHash;</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwName1;</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwName2;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// If we have HET table, use that one</span></div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a964afcb85acb567a58ef4066b579fd51">pHetTable</a> != NULL)</div>
<div class="line"><span class="lineno">  419</span>    {</div>
<div class="line"><span class="lineno">  420</span>        pFileEntry = <a class="code hl_function" href="SBaseFileTable_8cpp.html#a0f0ecaa05c2cc900064865a814a8f587">GetFileEntryLocale</a>(ha, szFileName, 0);</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">if</span>(pFileEntry != NULL)</div>
<div class="line"><span class="lineno">  422</span>        {</div>
<div class="line"><span class="lineno">  423</span>            <span class="comment">// Allocate file name for the file entry</span></div>
<div class="line"><span class="lineno">  424</span>            <a class="code hl_function" href="SBaseFileTable_8cpp.html#a551f6e01e95accafb0042ae9b8d81e61">AllocateFileName</a>(ha, pFileEntry, szFileName);</div>
<div class="line"><span class="lineno">  425</span>        }</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  428</span>    }</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    <span class="comment">// If we have hash table, we use it</span></div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> != NULL)</div>
<div class="line"><span class="lineno">  432</span>    {</div>
<div class="line"><span class="lineno">  433</span>        <span class="comment">// Get the end of the hash table and both names</span></div>
<div class="line"><span class="lineno">  434</span>        pHashEnd = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> + ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#afb1795fbecd5336fe21770ed1f76a33f">pHeader</a>-&gt;<a class="code hl_variable" href="struct__TMPQHeader.html#a67f1869dadee712c8210f77ce69cbfa9">dwHashTableSize</a>;</div>
<div class="line"><span class="lineno">  435</span>        dwName1 = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a5075170ac14f68563fd5548ad332fe38">pfnHashString</a>(szFileName, <a class="code hl_define" href="StormCommon_8h.html#a08f9b471c3381ddeeebb5975faf04df0">MPQ_HASH_NAME_A</a>);</div>
<div class="line"><span class="lineno">  436</span>        dwName2 = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a5075170ac14f68563fd5548ad332fe38">pfnHashString</a>(szFileName, <a class="code hl_define" href="StormCommon_8h.html#a00302198f2d31ea36041e90bf942bf02">MPQ_HASH_NAME_B</a>);</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>        <span class="comment">// Some protectors set very high hash table size (0x00400000 items or more)</span></div>
<div class="line"><span class="lineno">  439</span>        <span class="comment">// in order to make this process very slow. We will ignore items</span></div>
<div class="line"><span class="lineno">  440</span>        <span class="comment">// in the hash table that would be beyond the end of the file.</span></div>
<div class="line"><span class="lineno">  441</span>        <span class="comment">// Example MPQ: MPQ_2022_v1_Sniper.scx</span></div>
<div class="line"><span class="lineno">  442</span>        <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">dwFlags</a> &amp; <a class="code hl_define" href="StormLib_8h.html#a52801e7bcafa1210d50d7ae3adde08b7">MPQ_FLAG_HASH_TABLE_CUT</a>)</div>
<div class="line"><span class="lineno">  443</span>            pHashEnd = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a> + (ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aaa60e129a442934c74e6097c59b8b00f">dwRealHashTableSize</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="StormLib_8h.html#a3931032d33f7a8276dd15d842b04ce0c">TMPQHash</a>));</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>        <span class="comment">// Go through the hash table and put the name in each item that has the same name pair</span></div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordflow">for</span>(pHash = ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#ad3ec9127fcae2cd440073adbc3f21fba">pHashTable</a>; pHash &lt; pHashEnd; pHash++)</div>
<div class="line"><span class="lineno">  447</span>        {</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span>(pHash-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#a696c4e84a6fe64e4307dac7e06a1c907">dwName1</a> == dwName1 &amp;&amp; pHash-&gt;<a class="code hl_variable" href="struct__TMPQHash.html#ad005ba7c70d25b34c5756db9ce29c304">dwName2</a> == dwName2 &amp;&amp; <a class="code hl_define" href="StormLib_8h.html#af80d1aef7136d7c2c793a30c4048c1d9">MPQ_BLOCK_INDEX</a>(pHash) &lt; ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#aae2b6f26cfc5d09d2fc734947c82aabe">dwFileTableSize</a>)</div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                <span class="comment">// Allocate file name for the file entry</span></div>
<div class="line"><span class="lineno">  451</span>                <a class="code hl_function" href="SBaseFileTable_8cpp.html#a551f6e01e95accafb0042ae9b8d81e61">AllocateFileName</a>(ha, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a82a7283606d9775df50cb1c683280db1">pFileTable</a> + <a class="code hl_define" href="StormLib_8h.html#af80d1aef7136d7c2c793a30c4048c1d9">MPQ_BLOCK_INDEX</a>(pHash), szFileName);</div>
<div class="line"><span class="lineno">  452</span>            }</div>
<div class="line"><span class="lineno">  453</span>        }</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>        <span class="comment">// Go while we found something</span></div>
<div class="line"><span class="lineno">  456</span>        <span class="comment">//pFirstHash = pHash = GetFirstHashEntry(ha, szFileName);</span></div>
<div class="line"><span class="lineno">  457</span>        <span class="comment">//while(pHash != NULL)</span></div>
<div class="line"><span class="lineno">  458</span>        <span class="comment">//{</span></div>
<div class="line"><span class="lineno">  459</span>        <span class="comment">//    // Allocate file name for the file entry</span></div>
<div class="line"><span class="lineno">  460</span>        <span class="comment">//    AllocateFileName(ha, ha-&gt;pFileTable + MPQ_BLOCK_INDEX(pHash), szFileName);</span></div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>        <span class="comment">//    // Now find the next language version of the file</span></div>
<div class="line"><span class="lineno">  463</span>        <span class="comment">//    pHash = GetNextHashEntry(ha, pFirstHash, pHash);</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  467</span>    }</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="StormPort_8h.html#a9a012e4d53987470e70fa888f0a7ed90">ERROR_CAN_NOT_COMPLETE</a>;</div>
<div class="line"><span class="lineno">  470</span>}</div>
<div class="ttc" id="aSBaseFileTable_8cpp_html_a0f0ecaa05c2cc900064865a814a8f587"><div class="ttname"><a href="SBaseFileTable_8cpp.html#a0f0ecaa05c2cc900064865a814a8f587">GetFileEntryLocale</a></div><div class="ttdeci">TFileEntry * GetFileEntryLocale(TMPQArchive *ha, const char *szFileName, LCID lcFileLocale, LPDWORD PtrHashIndex)</div><div class="ttdef"><b>Definition</b> <a href="SBaseFileTable_8cpp_source.html#l01976">SBaseFileTable.cpp:1976</a></div></div>
<div class="ttc" id="aSBaseFileTable_8cpp_html_a551f6e01e95accafb0042ae9b8d81e61"><div class="ttname"><a href="SBaseFileTable_8cpp.html#a551f6e01e95accafb0042ae9b8d81e61">AllocateFileName</a></div><div class="ttdeci">void AllocateFileName(TMPQArchive *ha, TFileEntry *pFileEntry, const char *szFileName)</div><div class="ttdef"><b>Definition</b> <a href="SBaseFileTable_8cpp_source.html#l02040">SBaseFileTable.cpp:2040</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a00302198f2d31ea36041e90bf942bf02"><div class="ttname"><a href="StormCommon_8h.html#a00302198f2d31ea36041e90bf942bf02">MPQ_HASH_NAME_B</a></div><div class="ttdeci">#define MPQ_HASH_NAME_B</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00208">StormCommon.h:208</a></div></div>
<div class="ttc" id="aStormCommon_8h_html_a08f9b471c3381ddeeebb5975faf04df0"><div class="ttname"><a href="StormCommon_8h.html#a08f9b471c3381ddeeebb5975faf04df0">MPQ_HASH_NAME_A</a></div><div class="ttdeci">#define MPQ_HASH_NAME_A</div><div class="ttdef"><b>Definition</b> <a href="StormCommon_8h_source.html#l00207">StormCommon.h:207</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a3931032d33f7a8276dd15d842b04ce0c"><div class="ttname"><a href="StormLib_8h.html#a3931032d33f7a8276dd15d842b04ce0c">TMPQHash</a></div><div class="ttdeci">struct _TMPQHash TMPQHash</div></div>
<div class="ttc" id="aStormLib_8h_html_a52801e7bcafa1210d50d7ae3adde08b7"><div class="ttname"><a href="StormLib_8h.html#a52801e7bcafa1210d50d7ae3adde08b7">MPQ_FLAG_HASH_TABLE_CUT</a></div><div class="ttdeci">#define MPQ_FLAG_HASH_TABLE_CUT</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00190">StormLib.h:190</a></div></div>
<div class="ttc" id="aStormLib_8h_html_af80d1aef7136d7c2c793a30c4048c1d9"><div class="ttname"><a href="StormLib_8h.html#af80d1aef7136d7c2c793a30c4048c1d9">MPQ_BLOCK_INDEX</a></div><div class="ttdeci">#define MPQ_BLOCK_INDEX(pHash)</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00264">StormLib.h:264</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a9a012e4d53987470e70fa888f0a7ed90"><div class="ttname"><a href="StormPort_8h.html#a9a012e4d53987470e70fa888f0a7ed90">ERROR_CAN_NOT_COMPLETE</a></div><div class="ttdeci">#define ERROR_CAN_NOT_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00415">StormPort.h:415</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a5075170ac14f68563fd5548ad332fe38"><div class="ttname"><a href="struct__TMPQArchive.html#a5075170ac14f68563fd5548ad332fe38">_TMPQArchive::pfnHashString</a></div><div class="ttdeci">HASH_STRING pfnHashString</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00833">StormLib.h:833</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a964afcb85acb567a58ef4066b579fd51"><div class="ttname"><a href="struct__TMPQArchive.html#a964afcb85acb567a58ef4066b579fd51">_TMPQArchive::pHetTable</a></div><div class="ttdeci">TMPQHetTable * pHetTable</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00831">StormLib.h:831</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_aaa60e129a442934c74e6097c59b8b00f"><div class="ttname"><a href="struct__TMPQArchive.html#aaa60e129a442934c74e6097c59b8b00f">_TMPQArchive::dwRealHashTableSize</a></div><div class="ttdeci">DWORD dwRealHashTableSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00849">StormLib.h:849</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_afb1795fbecd5336fe21770ed1f76a33f"><div class="ttname"><a href="struct__TMPQArchive.html#afb1795fbecd5336fe21770ed1f76a33f">_TMPQArchive::pHeader</a></div><div class="ttdeci">TMPQHeader * pHeader</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00829">StormLib.h:829</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_a696c4e84a6fe64e4307dac7e06a1c907"><div class="ttname"><a href="struct__TMPQHash.html#a696c4e84a6fe64e4307dac7e06a1c907">_TMPQHash::dwName1</a></div><div class="ttdeci">DWORD dwName1</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00622">StormLib.h:622</a></div></div>
<div class="ttc" id="astruct__TMPQHash_html_ad005ba7c70d25b34c5756db9ce29c304"><div class="ttname"><a href="struct__TMPQHash.html#ad005ba7c70d25b34c5756db9ce29c304">_TMPQHash::dwName2</a></div><div class="ttdeci">DWORD dwName2</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00625">StormLib.h:625</a></div></div>
<div class="ttc" id="astruct__TMPQHeader_html_a67f1869dadee712c8210f77ce69cbfa9"><div class="ttname"><a href="struct__TMPQHeader.html#a67f1869dadee712c8210f77ce69cbfa9">_TMPQHeader::dwHashTableSize</a></div><div class="ttdeci">DWORD dwHashTableSize</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00560">StormLib.h:560</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a28970c3b2769a1db546e497b138e2034_cgraph.svg" width="100%" height="457"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a28970c3b2769a1db546e497b138e2034_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a7c9b409ac37f567dd42aed8be7dee6eb" name="a7c9b409ac37f567dd42aed8be7dee6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c9b409ac37f567dd42aed8be7dee6eb">&#9670;&#160;</a></span>SListFileFindClose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SListFileFindClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hFind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00697">697</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  698</span>{</div>
<div class="line"><span class="lineno">  699</span>    <a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> * pCache = (<a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> *)hFind;</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a>(pCache);</div>
<div class="line"><span class="lineno">  702</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a7c9b409ac37f567dd42aed8be7dee6eb_cgraph.svg" width="334" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aba1c9038ee83a8240402172dbab5ff30" name="aba1c9038ee83a8240402172dbab5ff30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba1c9038ee83a8240402172dbab5ff30">&#9670;&#160;</a></span>SListFileFindFirstFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SListFileFindFirstFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hMpq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="StormPort_8h.html#a03bdb8ce5895c7e261aadc2529637546">TCHAR</a> *&#160;</td>
          <td class="paramname"><em>szListFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_2src_2zlib_2zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>szMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00668">668</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  669</span>{</div>
<div class="line"><span class="lineno">  670</span>    <a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> * pCache = NULL;</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">// Initialize the structure with zeros</span></div>
<div class="line"><span class="lineno">  673</span>    memset(lpFindFileData, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct__SFILE__FIND__DATA.html">SFILE_FIND_DATA</a>));</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    <span class="comment">// Open the local/internal listfile</span></div>
<div class="line"><span class="lineno">  676</span>    pCache = <a class="code hl_function" href="SFileListFile_8cpp.html#a19d96cb819377f37c1632337009d6f52">CreateListFileCache</a>(hMpq, szListFile, szMask, 0, 0);</div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">if</span>(pCache != NULL)</div>
<div class="line"><span class="lineno">  678</span>    {</div>
<div class="line"><span class="lineno">  679</span>        <span class="keywordflow">if</span>(!<a class="code hl_function" href="SFileListFile_8cpp.html#a29315b5c89f4ff1691be43e6cc5b8eb0">DoListFileSearch</a>(pCache, lpFindFileData))</div>
<div class="line"><span class="lineno">  680</span>        {</div>
<div class="line"><span class="lineno">  681</span>            memset(lpFindFileData, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct__SFILE__FIND__DATA.html">SFILE_FIND_DATA</a>));</div>
<div class="line"><span class="lineno">  682</span>            <a class="code hl_function" href="FileStream_8cpp.html#a65dd8d3e416ffbd6ac5f468c6bdccac9">SetLastError</a>(<a class="code hl_define" href="StormPort_8h.html#a9f424565beb1161bf33b31748c6c16ba">ERROR_NO_MORE_FILES</a>);</div>
<div class="line"><span class="lineno">  683</span>            <a class="code hl_function" href="SFileListFile_8cpp.html#abe247b168feddf4764a34c901353b65e">FreeListFileCache</a>(pCache);</div>
<div class="line"><span class="lineno">  684</span>            pCache = NULL;</div>
<div class="line"><span class="lineno">  685</span>        }</div>
<div class="line"><span class="lineno">  686</span>    }</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>    <span class="comment">// Return the listfile cache as handle</span></div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordflow">return</span> (<a class="code hl_typedef" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>)pCache;</div>
<div class="line"><span class="lineno">  690</span>}</div>
<div class="ttc" id="aSFileListFile_8cpp_html_a29315b5c89f4ff1691be43e6cc5b8eb0"><div class="ttname"><a href="SFileListFile_8cpp.html#a29315b5c89f4ff1691be43e6cc5b8eb0">DoListFileSearch</a></div><div class="ttdeci">static bool DoListFileSearch(TListFileCache *pCache, SFILE_FIND_DATA *lpFindFileData)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00605">SFileListFile.cpp:605</a></div></div>
<div class="ttc" id="aStormPort_8h_html_aa8c0374618b33785ccb02f74bcfebc46"><div class="ttname"><a href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a></div><div class="ttdeci">void * HANDLE</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00342">StormPort.h:342</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_aba1c9038ee83a8240402172dbab5ff30_cgraph.svg" width="564" height="208"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a391fb032f484224b1aa8989663f9357a" name="a391fb032f484224b1aa8989663f9357a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a391fb032f484224b1aa8989663f9357a">&#9670;&#160;</a></span>SListFileFindNextFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="StormPort_8h.html#a9aa60e1ead64be77ad551e745cbfd4d3">WINAPI</a> SListFileFindNextFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormPort_8h.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&#160;</td>
          <td class="paramname"><em>hFind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#ac80854a06a92ee69e22c1d2c1fc5b5b9">SFILE_FIND_DATA</a> *&#160;</td>
          <td class="paramname"><em>lpFindFileData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00692">692</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  693</span>{</div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="SFileListFile_8cpp.html#a29315b5c89f4ff1691be43e6cc5b8eb0">DoListFileSearch</a>((<a class="code hl_struct" href="structTListFileCache.html">TListFileCache</a> *)hFind, lpFindFileData);</div>
<div class="line"><span class="lineno">  695</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_a391fb032f484224b1aa8989663f9357a_cgraph.svg" width="547" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae3a5effd18cd4d2e541c23e87f4c52ea" name="ae3a5effd18cd4d2e541c23e87f4c52ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3a5effd18cd4d2e541c23e87f4c52ea">&#9670;&#160;</a></span>SListFileSaveToMpq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> SListFileSaveToMpq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="StormLib_8h.html#a0b98dca19d4c344762c4dde4d810a5a9">TMPQArchive</a> *&#160;</td>
          <td class="paramname"><em>ha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SFileListFile_8cpp_source.html#l00473">473</a> of file <a class="el" href="SFileListFile_8cpp_source.html">SFileListFile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  474</span>{</div>
<div class="line"><span class="lineno">  475</span>    <a class="code hl_struct" href="struct__TMPQFile.html">TMPQFile</a> * hf = NULL;</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_typedef" href="StormPort_8h.html#ac2d3fb16b5b34c1e6ab80014309020eb">LPBYTE</a> pbListFile;</div>
<div class="line"><span class="lineno">  477</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> cbListFile = 0;</div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_typedef" href="StormPort_8h.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> dwErrCode = <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">// Only save the listfile if we should do so</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#af277e7bdab70f04a3019a18ef37a701a">dwFileFlags1</a> != 0)</div>
<div class="line"><span class="lineno">  482</span>    {</div>
<div class="line"><span class="lineno">  483</span>        <span class="comment">// At this point, we expect to have at least one reserved entry in the file table</span></div>
<div class="line"><span class="lineno">  484</span>        assert(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">dwFlags</a> &amp; <a class="code hl_define" href="StormLib_8h.html#af0170e1f41f3b3d32bbcdfd769f874f1">MPQ_FLAG_LISTFILE_NEW</a>);</div>
<div class="line"><span class="lineno">  485</span>        assert(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a9eae90efbf3e52b5bb0b400eb157547e">dwReservedFiles</a> &gt; 0);</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>        <span class="comment">// Create the raw data that is to be written to (listfile)</span></div>
<div class="line"><span class="lineno">  488</span>        <span class="comment">// Note: Creating the raw data before the (listfile) has been created in the MPQ</span></div>
<div class="line"><span class="lineno">  489</span>        <span class="comment">// causes that the name of the listfile will not be included in the listfile itself.</span></div>
<div class="line"><span class="lineno">  490</span>        <span class="comment">// That is OK, because (listfile) in Blizzard MPQs does not contain it either.</span></div>
<div class="line"><span class="lineno">  491</span>        pbListFile = <a class="code hl_function" href="SFileListFile_8cpp.html#ad4d14a643cddff424c694883ca753659">CreateListFile</a>(ha, &amp;cbListFile);</div>
<div class="line"><span class="lineno">  492</span>        <span class="keywordflow">if</span>(pbListFile != NULL)</div>
<div class="line"><span class="lineno">  493</span>        {</div>
<div class="line"><span class="lineno">  494</span>            <span class="comment">// Determine the real flags for (listfile)</span></div>
<div class="line"><span class="lineno">  495</span>            <span class="keywordflow">if</span>(ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#af277e7bdab70f04a3019a18ef37a701a">dwFileFlags1</a> == <a class="code hl_define" href="StormLib_8h.html#a68eb00ea1d1dc41a4de2bba26a2315e0">MPQ_FILE_DEFAULT_INTERNAL</a>)</div>
<div class="line"><span class="lineno">  496</span>                ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#af277e7bdab70f04a3019a18ef37a701a">dwFileFlags1</a> = <a class="code hl_function" href="SBaseCommon_8cpp.html#a2c4f65854e516a828f691cde03e83a4e">GetDefaultSpecialFileFlags</a>(cbListFile, ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#afb1795fbecd5336fe21770ed1f76a33f">pHeader</a>-&gt;<a class="code hl_variable" href="struct__TMPQHeader.html#a26c350cb08d35f2ffc4e75c380ed7901">wFormatVersion</a>);</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>            <span class="comment">// Create the listfile in the MPQ</span></div>
<div class="line"><span class="lineno">  499</span>            dwErrCode = <a class="code hl_function" href="SFileAddFile_8cpp.html#aaaf4e78e576b14cb224df4e9b07af824">SFileAddFile_Init</a>(ha, <a class="code hl_define" href="StormLib_8h.html#ac797c1c425d999b5bc992e2e39b4169e">LISTFILE_NAME</a>,</div>
<div class="line"><span class="lineno">  500</span>                                           0,</div>
<div class="line"><span class="lineno">  501</span>                                           cbListFile,</div>
<div class="line"><span class="lineno">  502</span>                                           <a class="code hl_define" href="StormLib_8h.html#a1e2d59a08fba74a56a63865a6001cdfc">LANG_NEUTRAL</a>,</div>
<div class="line"><span class="lineno">  503</span>                                           ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#af277e7bdab70f04a3019a18ef37a701a">dwFileFlags1</a> | <a class="code hl_define" href="StormLib_8h.html#aa273ca9983adfbfa82fe442303f27f32">MPQ_FILE_REPLACEEXISTING</a>,</div>
<div class="line"><span class="lineno">  504</span>                                          &amp;hf);</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>            <span class="comment">// Write the listfile raw data to it</span></div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordflow">if</span>(dwErrCode == <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  508</span>            {</div>
<div class="line"><span class="lineno">  509</span>                <span class="comment">// Write the content of the listfile to the MPQ</span></div>
<div class="line"><span class="lineno">  510</span>                dwErrCode = <a class="code hl_function" href="SFileAddFile_8cpp.html#af071d20ed3992c47bfc3f43a8a7e5875">SFileAddFile_Write</a>(hf, pbListFile, cbListFile, <a class="code hl_define" href="StormLib_8h.html#ac70d5d9d0a9f5d020ba7c84b6d441edb">MPQ_COMPRESSION_ZLIB</a>);</div>
<div class="line"><span class="lineno">  511</span>                <a class="code hl_function" href="SFileAddFile_8cpp.html#ad506ad6eb0b4f76671ddc7e4a827daa0">SFileAddFile_Finish</a>(hf);</div>
<div class="line"><span class="lineno">  512</span>            }</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>            <span class="comment">// Clear the listfile flags</span></div>
<div class="line"><span class="lineno">  515</span>            ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a4f1bf356f8e6dd8d3ec1faeec821aa6c">dwFlags</a> &amp;= ~(<a class="code hl_define" href="StormLib_8h.html#af0170e1f41f3b3d32bbcdfd769f874f1">MPQ_FLAG_LISTFILE_NEW</a> | <a class="code hl_define" href="StormLib_8h.html#a8ce12f91713bf164a65c77429ec519d7">MPQ_FLAG_LISTFILE_NONE</a>);</div>
<div class="line"><span class="lineno">  516</span>            ha-&gt;<a class="code hl_variable" href="struct__TMPQArchive.html#a9eae90efbf3e52b5bb0b400eb157547e">dwReservedFiles</a>--;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>            <span class="comment">// Free the listfile buffer</span></div>
<div class="line"><span class="lineno">  519</span>            <a class="code hl_define" href="StormCommon_8h.html#a50487dadfceefebfb0de8fa711eaf4b3">STORM_FREE</a>(pbListFile);</div>
<div class="line"><span class="lineno">  520</span>        }</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  522</span>        {</div>
<div class="line"><span class="lineno">  523</span>            <span class="comment">// If the (listfile) file would be empty, its OK</span></div>
<div class="line"><span class="lineno">  524</span>            dwErrCode = (cbListFile == 0) ? <a class="code hl_define" href="StormPort_8h.html#aea0ae801b7d25c979655a7eb20d034af">ERROR_SUCCESS</a> : <a class="code hl_define" href="StormPort_8h.html#a0e8ed8133680d2d6b8909e71b8048307">ERROR_NOT_ENOUGH_MEMORY</a>;</div>
<div class="line"><span class="lineno">  525</span>        }</div>
<div class="line"><span class="lineno">  526</span>    }</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordflow">return</span> dwErrCode;</div>
<div class="line"><span class="lineno">  529</span>}</div>
<div class="ttc" id="aSBaseCommon_8cpp_html_a2c4f65854e516a828f691cde03e83a4e"><div class="ttname"><a href="SBaseCommon_8cpp.html#a2c4f65854e516a828f691cde03e83a4e">GetDefaultSpecialFileFlags</a></div><div class="ttdeci">DWORD GetDefaultSpecialFileFlags(DWORD dwFileSize, USHORT wFormatVersion)</div><div class="ttdef"><b>Definition</b> <a href="SBaseCommon_8cpp_source.html#l00402">SBaseCommon.cpp:402</a></div></div>
<div class="ttc" id="aSFileAddFile_8cpp_html_aaaf4e78e576b14cb224df4e9b07af824"><div class="ttname"><a href="SFileAddFile_8cpp.html#aaaf4e78e576b14cb224df4e9b07af824">SFileAddFile_Init</a></div><div class="ttdeci">DWORD SFileAddFile_Init(TMPQArchive *ha, const char *szFileName, ULONGLONG FileTime, DWORD dwFileSize, LCID lcFileLocale, DWORD dwFlags, TMPQFile **phf)</div><div class="ttdef"><b>Definition</b> <a href="SFileAddFile_8cpp_source.html#l00398">SFileAddFile.cpp:398</a></div></div>
<div class="ttc" id="aSFileAddFile_8cpp_html_ad506ad6eb0b4f76671ddc7e4a827daa0"><div class="ttname"><a href="SFileAddFile_8cpp.html#ad506ad6eb0b4f76671ddc7e4a827daa0">SFileAddFile_Finish</a></div><div class="ttdeci">DWORD SFileAddFile_Finish(TMPQFile *hf)</div><div class="ttdef"><b>Definition</b> <a href="SFileAddFile_8cpp_source.html#l00711">SFileAddFile.cpp:711</a></div></div>
<div class="ttc" id="aSFileAddFile_8cpp_html_af071d20ed3992c47bfc3f43a8a7e5875"><div class="ttname"><a href="SFileAddFile_8cpp.html#af071d20ed3992c47bfc3f43a8a7e5875">SFileAddFile_Write</a></div><div class="ttdeci">DWORD SFileAddFile_Write(TMPQFile *hf, const void *pvData, DWORD dwSize, DWORD dwCompression)</div><div class="ttdef"><b>Definition</b> <a href="SFileAddFile_8cpp_source.html#l00569">SFileAddFile.cpp:569</a></div></div>
<div class="ttc" id="aSFileListFile_8cpp_html_ad4d14a643cddff424c694883ca753659"><div class="ttname"><a href="SFileListFile_8cpp.html#ad4d14a643cddff424c694883ca753659">CreateListFile</a></div><div class="ttdeci">static LPBYTE CreateListFile(TMPQArchive *ha, DWORD *pcbListFile)</div><div class="ttdef"><b>Definition</b> <a href="SFileListFile_8cpp_source.html#l00311">SFileListFile.cpp:311</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a1e2d59a08fba74a56a63865a6001cdfc"><div class="ttname"><a href="StormLib_8h.html#a1e2d59a08fba74a56a63865a6001cdfc">LANG_NEUTRAL</a></div><div class="ttdeci">#define LANG_NEUTRAL</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00401">StormLib.h:401</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a68eb00ea1d1dc41a4de2bba26a2315e0"><div class="ttname"><a href="StormLib_8h.html#a68eb00ea1d1dc41a4de2bba26a2315e0">MPQ_FILE_DEFAULT_INTERNAL</a></div><div class="ttdeci">#define MPQ_FILE_DEFAULT_INTERNAL</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00231">StormLib.h:231</a></div></div>
<div class="ttc" id="aStormLib_8h_html_a8ce12f91713bf164a65c77429ec519d7"><div class="ttname"><a href="StormLib_8h.html#a8ce12f91713bf164a65c77429ec519d7">MPQ_FLAG_LISTFILE_NONE</a></div><div class="ttdeci">#define MPQ_FLAG_LISTFILE_NONE</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00197">StormLib.h:197</a></div></div>
<div class="ttc" id="aStormLib_8h_html_aa273ca9983adfbfa82fe442303f27f32"><div class="ttname"><a href="StormLib_8h.html#aa273ca9983adfbfa82fe442303f27f32">MPQ_FILE_REPLACEEXISTING</a></div><div class="ttdeci">#define MPQ_FILE_REPLACEEXISTING</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00227">StormLib.h:227</a></div></div>
<div class="ttc" id="aStormLib_8h_html_ac70d5d9d0a9f5d020ba7c84b6d441edb"><div class="ttname"><a href="StormLib_8h.html#ac70d5d9d0a9f5d020ba7c84b6d441edb">MPQ_COMPRESSION_ZLIB</a></div><div class="ttdeci">#define MPQ_COMPRESSION_ZLIB</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00268">StormLib.h:268</a></div></div>
<div class="ttc" id="aStormLib_8h_html_af0170e1f41f3b3d32bbcdfd769f874f1"><div class="ttname"><a href="StormLib_8h.html#af0170e1f41f3b3d32bbcdfd769f874f1">MPQ_FLAG_LISTFILE_NEW</a></div><div class="ttdeci">#define MPQ_FLAG_LISTFILE_NEW</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00198">StormLib.h:198</a></div></div>
<div class="ttc" id="aStormPort_8h_html_a0e8ed8133680d2d6b8909e71b8048307"><div class="ttname"><a href="StormPort_8h.html#a0e8ed8133680d2d6b8909e71b8048307">ERROR_NOT_ENOUGH_MEMORY</a></div><div class="ttdeci">#define ERROR_NOT_ENOUGH_MEMORY</div><div class="ttdef"><b>Definition</b> <a href="StormPort_8h_source.html#l00405">StormPort.h:405</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_a9eae90efbf3e52b5bb0b400eb157547e"><div class="ttname"><a href="struct__TMPQArchive.html#a9eae90efbf3e52b5bb0b400eb157547e">_TMPQArchive::dwReservedFiles</a></div><div class="ttdeci">DWORD dwReservedFiles</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00842">StormLib.h:842</a></div></div>
<div class="ttc" id="astruct__TMPQArchive_html_af277e7bdab70f04a3019a18ef37a701a"><div class="ttname"><a href="struct__TMPQArchive.html#af277e7bdab70f04a3019a18ef37a701a">_TMPQArchive::dwFileFlags1</a></div><div class="ttdeci">DWORD dwFileFlags1</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00844">StormLib.h:844</a></div></div>
<div class="ttc" id="astruct__TMPQFile_html"><div class="ttname"><a href="struct__TMPQFile.html">_TMPQFile</a></div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00863">StormLib.h:864</a></div></div>
<div class="ttc" id="astruct__TMPQHeader_html_a26c350cb08d35f2ffc4e75c380ed7901"><div class="ttname"><a href="struct__TMPQHeader.html#a26c350cb08d35f2ffc4e75c380ed7901">_TMPQHeader::wFormatVersion</a></div><div class="ttdeci">USHORT wFormatVersion</div><div class="ttdef"><b>Definition</b> <a href="StormLib_8h_source.html#l00546">StormLib.h:546</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ae3a5effd18cd4d2e541c23e87f4c52ea_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SFileListFile_8cpp_ae3a5effd18cd4d2e541c23e87f4c52ea_icgraph.svg" width="100%" height="477"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a65adb78194d8b06ca6fd510af8357a.html">AscEmu</a></li><li class="navelem"><a class="el" href="dir_d0fc04153d74feb886fd2096a57dc87f.html">dep</a></li><li class="navelem"><a class="el" href="dir_2594a7fc2f53d73154bdbd3e3b1986ef.html">StormLib</a></li><li class="navelem"><a class="el" href="dir_77224f19d90cfc88aa172a2cc692c112.html">src</a></li><li class="navelem"><a class="el" href="SFileListFile_8cpp.html">SFileListFile.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
